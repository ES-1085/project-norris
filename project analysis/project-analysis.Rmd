---
title: "Project Analysis [insert catchy name here]"
author: "Cedar and Joanna"
date: "`r Sys.Date()`"
output: html_document
---

# Library and Data Read-In

```{r load-packages, echo = FALSE, message = FALSE, warning = FALSE}
library(sf)
library(htmltools)
library(leafsync)
library(rgeoboundaries)
library(kableExtra)
library(tidyverse)
library(leaflet)
library(ggthemes)
library(ggridges)
library(ggmap)
library(lubridate)
library(stringr)
library(readr)
library(broom)
library(RColorBrewer)
library(forcats)
library(colorspace)
library(visdat)
library(naniar)
library(ggrepel)
library(styler)
library(lintr)
```

```{r data-read-in}
tri_data <- read_csv("../data/tri_data.csv", show_col_types = FALSE)
```

# Outline

# Introduction

introduction to dataset & summary stats introduce primary research question: what is the relationship between industry sector and location, pollution, chemical use and has this shifted over the past 10 years?

# Data Overview


## Location Analysis

location of facilities, location trends, tribal lands, proximity question: how many facilities are located on tribal land and is there a significant difference in the type and amount of chemical release when compared to facilities not on tribal land?

```{r facility-location-dataset, echo = FALSE, message = FALSE}
facility_location <- tri_data %>% 
  select("facility_name", "street_address", "city", "county", "state", "zip_code", "bia_code", "tribal_land", "latitude", "longitude") %>% 
  distinct()

facility_location <- facility_location %>% 
  mutate(tribal_yes_no = case_when(is.na(tribal_land) == FALSE ~ "Tribal Land",
                                   TRUE ~ "Not Tribal Land"))

tri_data <- tri_data %>% 
  mutate(tribal_yes_no = case_when(is.na(tribal_land) == FALSE ~ "Tribal Land",
                                   TRUE ~ "Not Tribal Land"))
```

### Number of Facilities Owned by Each Company

```{r number-of-facilities, echo = FALSE, message = FALSE}
tri_data %>% 
  select(standard_parent_co_name, parent_co_name, facility_name) %>% 
  group_by(standard_parent_co_name, parent_co_name) %>% 
  summarise(number_of_facilities = n_distinct(facility_name)) %>% 
  arrange(desc(number_of_facilities))
```

### Map of Facilities
```{r facility-map, echo = FALSE, message = FALSE}
tri_data %>% 
  distinct(longitude, latitude, facility_name, parent_co_name, industry_sector, city, state) %>% 
  leaflet() %>% 
  addTiles() %>% 
    addCircleMarkers(lng = ~longitude, 
                 lat = ~latitude, 
                 clusterOptions = markerClusterOptions(),
                 popup = ~paste0(facility_name, "<br>", parent_co_name, "<br>", industry_sector, "<br>", city, ", ", state))
```

### Percent of Facilities on Tribal Land
```{r percent-tribal-land, echo = FALSE, message = FALSE}
facility_location %>% 
  select(tribal_yes_no) %>% 
  group_by(tribal_yes_no) %>%
  summarise(percent = 100 * n()/nrow(facility_location))
```


## Industry Analysis

industry sector trends (location, chemical use, pollution), changes in industry sector prevalence question: is there a correlation between industry sector and frequency of carcinogen, pfas, and pbt use?

```{r industry-sector-dataset, echo = FALSE, message = FALSE}
industry_info <- tri_data %>% 
  select(industry_sector, state, clean_air_act_chemical, carcinogen, metal_category, pbt, pfas, on_site_release_total, off_site_release_total, on_site_contained, off_site_contain) %>% 
  distinct(industry_sector, state, clean_air_act_chemical, carcinogen, metal_category, pbt, pfas, on_site_release_total, off_site_release_total, on_site_contained, off_site_contain)
```

```{r industry-sector-categories}
tri_data <- tri_data %>% 
  mutate(industry_sector_category = case_when(industry_sector %in% c("Tobacco", "Beverages", "Food") ~ "Agriculture and Food Processing",
  industry_sector %in% c("Electrical Equipment", "Transportation Equipment", "Machinery", "Computers and Electronic     Products") ~ "Machinery and Technology",
  industry_sector %in% c("Miscellaneous Manufacturing", "Other") ~ "Misc",
  industry_sector %in% c("Chemicals", "Chemical Wholesalers", "Hazardous Waste") ~ "Chemicals and Waste",
  industry_sector %in% c("Leather", "Apparel", "Textiles", "Textile Product") ~ "Textiles and Leather",
  industry_sector %in% c("Petroleum Bulk Terminals", "Petroleum") ~ "Petroleum",
  industry_sector %in% c("Metal Mining", "Coal Mining") ~ "Mining",
  industry_sector %in% c("Nonmetallic Mineral Product", "Plastics and Rubber", "Fabricated Metals", "Primary Metals") ~ "Processed Materials",
  industry_sector %in% c("Furniture", "Wood Products", "Paper", "Printing", "Publishing") ~ "Wood and Paper",
  industry_sector %in% "Electric Utilities" ~ "Electric Utilities"))
```

### Industry Sector Distribution
```{r industry-sector-distribution, echo = FALSE, message = FALSE}
tri_data %>% 
 select(industry_sector) %>% 
 group_by(industry_sector) %>%
 summarise(percent = 100 * n()/nrow(tri_data)) %>% 
 arrange(desc(percent))
```

#### Industry Sector Distribution Graph
```{r industry-sector-category-distribution}
tri_data %>% 
  ggplot(aes(y = fct_infreq(industry_sector_category), fill = industry_sector_category)) +
  geom_bar(fill = "#1F948C")
```

### Carcinogen Percentage by Industry Sector (Graph)
```{r}
tri_data %>% 
  ggplot(aes(y = fct_infreq(industry_sector), fill = carcinogen)) +
  geom_bar() +
  scale_fill_viridis_d()
```


## Chemical Analysis

chemical info (type, category, etc), trends in chemical use and disposal question: is there a correlation between location and frequency of use of Clean Air Act chemicals?

```{r chemical-info-dataset, echo = FALSE, message = FALSE}
chemical_info <- tri_data %>% 
  select(chemical, elemental_metal_included, clean_air_act_chemical, metal, metal_category, carcinogen, pbt, pfas) %>% 
  distinct(chemical, elemental_metal_included, clean_air_act_chemical, metal, metal_category, carcinogen, pbt, pfas) %>% 
  arrange(chemical)
```

```{r chemical-percent, echo = FALSE, message = FALSE}
tri_data %>% 
  select(chemical) %>% 
  group_by(chemical) %>%
  summarise(percent = 100 * n()/nrow(tri_data)) %>% 
  arrange(desc(percent))
```

### Chemical Category Calculations
```{r chemical-percent-elemental-metal-included, echo = FALSE, message = FALSE}
tri_data %>% 
  select(elemental_metal_included) %>% 
  group_by(elemental_metal_included) %>%
  summarise(percent = 100 * n()/nrow(tri_data)) %>% 
  arrange(desc(percent))
```

```{r chemical-percent-clean-air-act, echo = FALSE, message = FALSE}
tri_data %>% 
  select(clean_air_act_chemical) %>% 
  group_by(clean_air_act_chemical) %>%
  summarise(percent = 100 * n()/nrow(tri_data)) %>% 
  arrange(desc(percent))
```

```{r chemical-percent-metal, echo = FALSE, message = FALSE}
tri_data %>% 
  select(metal) %>% 
  group_by(metal) %>%
  summarise(percent = 100 * n()/nrow(tri_data)) %>% 
  arrange(desc(percent))
```

```{r chemical-percent-metal-category, echo = FALSE, message = FALSE}
tri_data %>% 
  select(metal_category) %>% 
  group_by(metal_category) %>%
  summarise(percent = 100 * n()/nrow(tri_data)) %>% 
  arrange(desc(percent))
```

```{r chemical-percent-carcinogen, echo = FALSE, message = FALSE}
tri_data %>% 
  select(carcinogen) %>% 
  group_by(carcinogen) %>%
  summarise(percent = 100 * n()/nrow(tri_data)) %>% 
  arrange(desc(percent))
```

```{r chemical-percent-pbt, echo = FALSE, message = FALSE}
tri_data %>% 
  select(pbt) %>% 
  group_by(pbt) %>%
  summarise(percent = 100 * n()/nrow(tri_data)) %>% 
  arrange(desc(percent))
```

```{r chemical-percent-pfas, echo = FALSE, message = FALSE}
tri_data %>% 
  select(pfas) %>% 
  group_by(pfas) %>%
  summarise(percent = 100 * n()/nrow(tri_data)) %>% 
  arrange(desc(percent))
```

#### Chemical Categories (Graphs)
```{r chemical-trends-by-category-elemental-metal-included, echo = FALSE, message = FALSE}
tri_data %>% 
  select(year, elemental_metal_included, clean_air_act_chemical, metal, metal_category, carcinogen, pbt, pfas) %>% 
  distinct(year, elemental_metal_included, clean_air_act_chemical, metal, metal_category, carcinogen, pbt, pfas) %>% 
  ggplot(aes(x = elemental_metal_included, color = elemental_metal_included, fill = elemental_metal_included)) +
  geom_bar() +
  coord_flip() +
  facet_wrap(~year) 
```

```{r chemical-trends-by-category-clean-air-act, echo = FALSE, message = FALSE}
tri_data %>% 
  select(year, elemental_metal_included, clean_air_act_chemical, metal, metal_category, carcinogen, pbt, pfas) %>% 
  distinct(year, elemental_metal_included, clean_air_act_chemical, metal, metal_category, carcinogen, pbt, pfas) %>% 
  ggplot(aes(x = clean_air_act_chemical, color = clean_air_act_chemical, fill = clean_air_act_chemical)) +
  geom_bar() +
  coord_flip() +
  facet_wrap(~year) 
```

```{r chemical-trends-by-category-metal, echo = FALSE, message = FALSE}
tri_data %>% 
  select(year, elemental_metal_included, clean_air_act_chemical, metal, metal_category, carcinogen, pbt, pfas) %>% 
  distinct(year, elemental_metal_included, clean_air_act_chemical, metal, metal_category, carcinogen, pbt, pfas) %>% 
  ggplot(aes(x = metal, color = metal, fill = metal)) +
  geom_bar() +
  coord_flip() +
  facet_wrap(~year) 
``` 

```{r chemical-trends-by-category-metal-category, echo = FALSE, message = FALSE}
tri_data %>% 
  select(year, elemental_metal_included, clean_air_act_chemical, metal, metal_category, carcinogen, pbt, pfas) %>% 
  distinct(year, elemental_metal_included, clean_air_act_chemical, metal, metal_category, carcinogen, pbt, pfas) %>% 
  ggplot(aes(x = metal_category, color = metal_category, fill = metal_category)) +
  geom_bar() +
  coord_flip() +
  facet_wrap(~year) 
```

```{r chemical-trends-by-category-carcinogen, echo = FALSE, message = FALSE}
tri_data %>% 
  select(year, elemental_metal_included, clean_air_act_chemical, metal, metal_category, carcinogen, pbt, pfas) %>% 
  distinct(year, elemental_metal_included, clean_air_act_chemical, metal, metal_category, carcinogen, pbt, pfas) %>% 
  ggplot(aes(x = carcinogen, color = carcinogen, fill = carcinogen)) +
  geom_bar() +
  coord_flip() +
  facet_wrap(~year) 
```

```{r chemical-trends-by-category-pbt, echo = FALSE, message = FALSE}
tri_data %>% 
  select(year, elemental_metal_included, clean_air_act_chemical, metal, metal_category, carcinogen, pbt, pfas) %>% 
  distinct(year, elemental_metal_included, clean_air_act_chemical, metal, metal_category, carcinogen, pbt, pfas) %>% 
  ggplot(aes(x = pbt, color = pbt, fill = pbt)) +
  geom_bar() +
  coord_flip() +
  facet_wrap(~year) 
```

```{r chemical-trends-by-category-pfas, echo = FALSE, message = FALSE}
tri_data %>% 
  select(year, elemental_metal_included, clean_air_act_chemical, metal, metal_category, carcinogen, pbt, pfas) %>% 
  distinct(year, elemental_metal_included, clean_air_act_chemical, metal, metal_category, carcinogen, pbt, pfas) %>% 
  ggplot(aes(x = pfas, color = pfas, fill = pfas)) +
  geom_bar() +
  coord_flip() +
  facet_wrap(~year) 
```

##### Metal Category Pie Chart
```{r metal-category-pie-chart, echo = FALSE, message = FALSE}
tri_data %>% 
  group_by(metal_category) %>% 
  summarise(prop = n()/nrow(tri_data)) %>% 
  ggplot(aes(x = "", y = prop, fill = fct_inorder(metal_category))) +
  geom_col(color = "white", linewidth = .3) +
  geom_text(aes(x = "", y = prop, label = round(prop, 2)), position = position_stack(vjust = 0.5)) +
 # geom_label_repel(aes(x = "", y = prop, label = paste0(prop, "%")), size = 4.5, nudge_x = 1, show.legend = FALSE) +
  coord_polar(theta = "y") +
  scale_fill_viridis_d()
```

### Chemical Categories
```{r carcinogen-percent-yes, echo = FALSE, message = FALSE}
chemical_info %>% 
  select(chemical, carcinogen) %>% 
  filter(carcinogen == "YES") %>% 
  group_by(chemical)
```

```{r carcinogen-percent-no, echo = FALSE, message = FALSE}
chemical_info %>% 
  select(chemical, carcinogen) %>% 
  filter(carcinogen == "NO") %>% 
  group_by(chemical)
```

```{r pfas-percent-yes, echo = FALSE, message = FALSE}
chemical_info %>% 
  select(chemical, pfas) %>% 
  filter(pfas == "YES") %>% 
  group_by(chemical)
```

```{r pfas-percent-no, echo = FALSE, message = FALSE}
chemical_info %>% 
  select(chemical, pfas) %>% 
  filter(pfas == "NO") %>% 
  group_by(chemical)
```

```{r pbt-percent-yes, echo = FALSE, message = FALSE}
chemical_info %>% 
  select(chemical, pbt) %>% 
  filter(pbt == "YES") %>% 
  group_by(chemical)
```

```{r pbt-percent-no, echo = FALSE, message = FALSE}
chemical_info %>% 
  select(chemical, pbt) %>% 
  filter(pbt == "NO") %>% 
  group_by(chemical)
```


## Pollution analysis

trends in pollution, on-site vs off-site disposal question: what are the trends in pollution (chemical release) over the past 10 years?

```{r pollution-info-dataset, echo = FALSE, message = FALSE}
pollution_info <- tri_data %>% 
  select(year, fugitive_air, stack_air, water, underground, underground_class_1, underground_class_2_through_5, landfills, land_treatment, surface_impoundment, other_disposal, on_site_release_total, public_treatment_total_transfer, off_site_release_total, off_site_recycled_total, off_site_energy_recovery_total, off_site_treated_total, total_transfer, total_releases, releases, on_site_contained, on_site_other, off_site_contain, off_site_other)
```

### On-Site Pollution by Category 

#### By Type
On-site release types: variables `Underground`, `Landfill`, and `Surace Impoundment` are all zeros

```{r pollution-by-on-site-release-fugitive-air, echo = FALSE, message = FALSE}
pollution_info %>% 
  ggplot(aes(x = on_site_release_total, y = fugitive_air)) + 
  geom_smooth() +
  facet_wrap(~ year)
```

```{r pollution-by-on-site-release-stack-air, echo = FALSE, message = FALSE}
pollution_info %>% 
  ggplot(aes(x = on_site_release_total, y = stack_air)) +
  geom_smooth() +
  facet_wrap(~ year)
```

```{r pollution-by-on-site-release-water, echo = FALSE, message = FALSE}
pollution_info %>% 
  ggplot(aes(x = on_site_release_total, y = water)) +
  geom_smooth() +
  facet_wrap(~ year)
```

```{r pollution-by-on-site-release-underground-class-1, echo = FALSE, message = FALSE}
 pollution_info %>% 
   ggplot(aes(x = on_site_release_total, y = underground_class_1)) +
   geom_smooth() +
   facet_wrap(~ year)
```

```{r pollution-by-on-site-release-underground-class-2-to-5, echo = FALSE, message = FALSE}
pollution_info %>% 
  ggplot(aes(x = on_site_release_total, y = underground_class_2_through_5)) +
  geom_smooth() +
  facet_wrap(~ year)
```

```{r pollution-by-on-site-release-land-treatment, echo = FALSE, message = FALSE}
pollution_info %>% 
  ggplot(aes(x = on_site_release_total, y = land_treatment)) +
  geom_smooth() +
  facet_wrap(~ year)
```

```{r pollution-by-on-site-release-other-disposal, echo = FALSE, message = FALSE}
pollution_info %>% 
  ggplot(aes(x = on_site_release_total, y = other_disposal)) +
  geom_smooth() +
  facet_wrap(~ year)
```

#### By Year

```{r on-site-release-total-by-year, echo = FALSE, message = FALSE}
pollution_info %>% 
  ggplot(aes(x = year, y = on_site_release_total)) + 
  geom_smooth() 
```

### Pollution by General Category (Including On-site-total)

Pollution variable `Releases` is all zeros

```{r pollution-by-general-category}
pollution_info %>% 
  ggplot(aes(x = year, y = on_site_release_total)) + 
  geom_smooth() 
```

```{r pollution-public-treatment-total-transfer}
pollution_info %>% 
  ggplot(aes(x = year, y = public_treatment_total_transfer)) + 
  geom_smooth() 
```

```{r pollution-off-site-release-total}
pollution_info %>% 
  ggplot(aes(x = year, y = off_site_release_total)) + 
  geom_smooth() 
```

```{r pollution-off-site-recycled-total}
pollution_info %>% 
  ggplot(aes(x = year, y = off_site_recycled_total)) + 
  geom_smooth() 
```

```{r pollution-off-site-energy-recovery-total}
pollution_info %>% 
  ggplot(aes(x = year, y = off_site_energy_recovery_total)) + 
  geom_smooth() 
```

```{r pollution-off-site-treated-total}
pollution_info %>% 
  ggplot(aes(x = year, y = off_site_treated_total)) + 
  geom_smooth() 
```

```{r pollution-total-transfer}
pollution_info %>% 
  ggplot(aes(x = year, y = total_transfer)) + 
  geom_smooth() 
```

```{r pollution-total-releases}
pollution_info %>% 
  ggplot(aes(x = year, y = total_releases)) + 
  geom_smooth() 
```

```{r pollution-on-site-contained}
pollution_info %>% 
  ggplot(aes(x = year, y = on_site_contained)) + 
  geom_smooth() 
```

```{r pollution-on-site-other}
pollution_info %>% 
  ggplot(aes(x = year, y = on_site_other)) + 
  geom_smooth() 
```

```{r pollution-off-site-contain}
pollution_info %>% 
  ggplot(aes(x = year, y = off_site_contain)) + 
  geom_smooth() 
```

```{r pollution-off-site-other}
pollution_info %>% 
  ggplot(aes(x = year, y = off_site_other)) + 
  geom_smooth() 
```

### Pollution: Water/on-site-release-total

```{r pollution-water-log-graph}
tri_data %>%
  filter(water > 0) %>%
  ggplot(aes(x = log10(on_site_release_total), y = water/on_site_release_total, color = industry_sector_category)) +
  geom_point(alpha = 0.3) +
  scale_color_viridis_d() +
  facet_wrap(~ industry_sector_category)
```

### Amount of water release by Industry Sector Category

```{r industry-sector-category-water-release}
tri_data %>% 
  ggplot(aes(y = industry_sector_category, x = water, fill = industry_sector_category)) +
  geom_col(fill = "#1F948C")
```



# Detailed Analysis

```{r create-analysis-data-frame}
chemical_analysis_data <- tri_data %>% 
  filter(chemical %in% c("Arsenic", "Styrene", "Formaldehyde", "Nickel", "Chromium", "Lead", "Mercury", "Ammonia", "Phosphorus (yellow or white)", "Chloroform", "Benzo[g,h,i]perylene")) 

# chemical_analysis_data <- chemical_analysis_data %>% 
#  mutate(off_site_total %in% c("off_site_release_total", "off_site_recycled_total", "off_site_energy_recovery_total", "public_treatment_total_transfer", "off_site_treated_total", "total_transver", "off_site_contain", "off_site_other"))

# chemical_analysis_data <- chemical_analysis_data %>% 
#  mutate(off_site_total = c("off_site_release_total", "off_site_recycled_total", "off_site_energy_recovery_total", "public_treatment_total_transfer", "off_site_treated_total", "total_transver", "off_site_contain", "off_site_other"))

# chemical_analysis_data <- chemical_analysis_data %>% 
#  mutate(off_site_total = sum(c("off_site_release_total", "off_site_recycled_total", "off_site_energy_recovery_total", "public_treatment_total_transfer", "off_site_treated_total", "total_transver", "off_site_contain", "off_site_other")))

# chemical_analysis_data <- chemical_analysis_data %>% 
#   mutate(off_site_total = c("off_site_release_total" + "off_site_recycled_total" + "off_site_energy_recovery_total" + "public_treatment_total_transfer" + "off_site_treated_total" + "total_transver" + "off_site_contain" + "off_site_other")))

# chemical_analysis_data <- chemical_analysis_data %>% 
#  mutate(off_site_total %in% c("off_site_release_total" + "off_site_recycled_total" + "off_site_energy_recovery_total" + "public_treatment_total_transfer" + "off_site_treated_total" + "total_transver" + "off_site_contain" + "off_site_other"))

# chemical_analysis_data %>% 
#   mutate(off_site_total == sum(c("off_site_release_total" + "off_site_recycled_total" + "off_site_energy_recovery_total" + "public_treatment_total_transfer" + "off_site_treated_total" + "total_transver" + "off_site_contain" + "off_site_other")))

# chemical_analysis_data %>% 
#   mutate(off_site_total = sum(c("off_site_release_total", "off_site_recycled_total", "off_site_energy_recovery_total", "public_treatment_total_transfer", "off_site_treated_total", "total_transver", "off_site_contain", "off_site_other")))

# chemical_analysis_data %>% 
#   mutate(off_site_total = sum("off_site_release_total" + "off_site_recycled_total" + "off_site_energy_recovery_total" + "public_treatment_total_transfer" + "off_site_treated_total" + "total_transver" + "off_site_contain" + "off_site_other"))

# chemical_analysis_data %>% 
#   sum(c(off_site_release_total, off_site_recycled_total, off_site_energy_recovery_total, public_treatment_total_transfer, off_site_treated_total, total_transver, off_site_contain, off_site_other))
```


## Chemicals and Location

```{r create-chemical-and-state-frame}
chemicals_and_states <- chemical_analysis_data %>% 
  select(chemical, state) %>% 
  group_by(state, chemical)
```

```{r count-chemical-and-type}
chemical_analysis_data %>% 
  count(chemical) %>% 
  arrange(desc(n))

chemical_analysis_data %>% 
  select(chemical, pfas, pbt, clean_air_act_chemical, carcinogen) %>% 
  group_by(chemical) %>% 
  count(pfas, pbt, clean_air_act_chemical, carcinogen) %>% 
  arrange(chemical)
```
### Graphs of on-site disposal by type

```{r plot-fugitive-air-release-by-chemical}
chemical_analysis_data %>% 
  ggplot(aes(x = on_site_release_total, y = fugitive_air)) +
  geom_point(aes(alpha = 0.3, color = chemical)) +
  scale_color_viridis_d() +
  scale_fill_viridis_d() +
  facet_wrap(~ chemical)
```

```{r plot-stack-air-release-by-chemical}
chemical_analysis_data %>% 
  ggplot(aes(x = on_site_release_total, y = stack_air)) +
  geom_point(aes(alpha = 0.3, color = chemical)) +
  scale_color_viridis_d() +
  scale_fill_viridis_d() +
  facet_wrap(~ chemical)
```

```{r plot-water-release-by-chemical}
chemical_analysis_data %>% 
  ggplot(aes(x = on_site_release_total, y = water)) +
  geom_point(aes(alpha = 0.3, color = chemical)) +
  scale_color_viridis_d() +
  scale_fill_viridis_d() +
  facet_wrap(~ chemical)
```

```{r plot-underground-class-1-release-by-chemical}
chemical_analysis_data %>% 
  ggplot(aes(x = on_site_release_total, y = underground_class_1)) +
  geom_point(aes(alpha = 0.3, color = chemical)) +
  scale_color_viridis_d() +
  scale_fill_viridis_d() +
  facet_wrap(~ chemical)
```

```{r plot-underground-2-to-5-release-by-chemical}
chemical_analysis_data %>% 
  ggplot(aes(x = on_site_release_total, y = underground_class_2_through_5)) +
  geom_point(aes(alpha = 0.3, color = chemical)) +
  scale_color_viridis_d() +
  scale_fill_viridis_d() +
  facet_wrap(~ chemical)
```

```{r plot-land-treatment-by-chemical}
chemical_analysis_data %>% 
  ggplot(aes(x = on_site_release_total, y = land_treatment)) +
  geom_point(aes(alpha = 0.3, color = chemical)) +
  scale_color_viridis_d() +
  scale_fill_viridis_d() +
  facet_wrap(~ chemical)
```

```{r plot-other-disposal-by-chemical}
chemical_analysis_data %>% 
  ggplot(aes(x = on_site_release_total, y = other_disposal)) +
  geom_point(aes(alpha = 0.3, color = chemical)) +
  scale_color_viridis_d() +
  scale_fill_viridis_d() +
  facet_wrap(~ chemical)
```

```{r plot-on-site-release-total-by-chemical}
chemical_analysis_data %>% 
  ggplot(aes(y = chemical, x = on_site_release_total, fill = chemical)) +
  geom_col() +
  scale_fill_viridis_d()
```

### Graphs of off-site disposal by type

```{r plot-public-treatment-transfer-by-chemical}
chemical_analysis_data %>% 
  ggplot(aes(x = off_site_treated_total, y = public_treatment_total_transfer)) +
  geom_point(aes(alpha = 0.3, color = chemical)) +
  scale_color_viridis_d() +
  scale_fill_viridis_d() +
  facet_wrap(~ chemical)
```

```{r plot-other-disposal-by-chemical}
chemical_analysis_data %>% 
  ggplot(aes(x = on_site_release_total, y = other_disposal)) +
  geom_point(aes(alpha = 0.3, color = chemical)) +
  scale_color_viridis_d() +
  scale_fill_viridis_d() +
  facet_wrap(~ chemical)
```

###


```{r}
#chemicals_and_states %>% 
#  select(state) %>% 

chemical_analysis_data %>% 
  select(state, chemical) %>% 
  group_by(state) %>% 
  summarise(chemical_amount = n_distinct(chemical)) %>% 
  arrange(desc(chemical_amount))

```

```{r}
chemicals_and_states %>% 
  group_by(chemical) %>% 
  top_n(5, wt = chemical_use) %>%
 # arrange(chemical)
  ggplot(aes(x = chemical_use, y = state), fill = chemical) +
  geom_col() +
  scale_fill_viridis_d()
```



```{r}
chemical_analysis_data %>% 
  ggplot(aes(y = chemical, x = on_site_release_total, fill = industry_sector_category)) +
  geom_col() +
  scale_fill_viridis_d()
  
```


##Chemicals and Pollution
##Chemicals and Categories
##Chemicals and Industry Sectors
# Conclusion

overview of data and conclusions about pollution and chemical use trends
