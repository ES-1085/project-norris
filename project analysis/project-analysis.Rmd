---
title: "Project Analysis: A Decade of Toxic Release"
author: "Cedar Callahan and Joanna Pittari"
date: "`r Sys.Date()`"
output: html_document
---

# Library and Data Read-In

```{r load-packages, echo = FALSE, message = FALSE, warning = FALSE}
library(sf)
library(htmltools)
library(leafsync)
library(kableExtra)
library(tidyverse)
library(leaflet)
library(ggthemes)
library(ggridges)
library(ggmap)
library(lubridate)
library(stringr)
library(readr)
library(broom)
library(RColorBrewer)
library(forcats)
library(colorspace)
library(visdat)
library(naniar)
library(ggrepel)
library(styler)
library(lintr)
```

```{r data-read-in, echo = FALSE, message = FALSE, warning = FALSE}
tri_data <- read_csv("../data/tri_data.csv", show_col_types = FALSE)
```

# Introduction

Every year, new chemicals to be reported to the EPA are added to the TRI's list, which means the amount of chemical variables within this one decade of 2011-2021 goes from 513 reported chemicals to 545 reported chemicals which actually accounts for around 200 additions and many undocumented deletions of variables (not counting the 16 that were added to the dataset in 2011). Rules on what qualifies as the threshold for reporting also change as certain chemicals fall in and out of especially-close watch. Countrywide and statewide laws on environmental protection grant even more opportunity for data to drastically change year by year, though in technicality, the actual happenings at these facilities may not be changing much at all. Some of these laws -- though not implying causation -- will be clarified where relevant in the code. It is important to note that the Environmental Protection Agency's database of Toxic Release Inventory lacks consistency in its observations and variables -- though this is likely due to the unexplained environment that informs the data.

Our goal is to use what data we find (that is reasonably accurate given the circumstances) in order to identify the layout of these waste chemicals across the United States. To reach this, we must ask some guiding questions: What are the relationships between differing industry sectors and their growing or declining locations? Are there any shifts in the levels of overall pollution during the past decade, and are these changes set in any specific part of the country? Finally, how has chemical use and waste (as well as waste procedures) changed in the past decade, and what do we know about these chemicals from the EPA to infer their threat to human health?

# Data Overview

## Location Analysis

Our first question of locations deals with the trends of facilities' presence, whether or not they are on tribal land, and their proximity to each other (possibly by industry sector) -- which may help in assessing what is in the best interest of the people due to identifying the patterns of popularity at the same time as keeping safety and land protection a priority.

```{r facility-location-dataset, echo = FALSE, message = FALSE, warning = FALSE}
facility_location <- tri_data %>% 
  select("facility_name", "street_address", "city", "county", "state", "zip_code", "bia_code", "tribal_land", "latitude", "longitude") %>% 
  distinct()

facility_location <- facility_location %>% 
  mutate(tribal_yes_no = case_when(is.na(tribal_land) == FALSE ~ "Tribal Land",
                                   TRUE ~ "Not Tribal Land"))

tri_data <- tri_data %>% 
  mutate(tribal_yes_no = case_when(is.na(tribal_land) == FALSE ~ "Tribal Land",
                                   TRUE ~ "Not Tribal Land"))
```

### Number of Facilities Owned by Each Company

The five most common parent companies are as follows: U.S. Department of Defense, CRH Americas Inc, Cemex Inc, Argos U.S. Corp, and Berkshire Hathaway Inc. The first listed is a government agency responsible for U.S. military protection, followed by four different building/construction/transport materials companies. However, given the high number of NA values in the `standard_parent_co_name` and `parent_co_name` variables, it is hard to know if these numbers are accurate. 

We also calculated the states with the most reported chemicals and facilities. Texas, Ohio, Illinois, Pennsylvania, and California had the most reported chemicals, while Texas, Ohio, California, Pennsylvania, and Illinois had the most facilities. We found it interesting that the same states make up the top five in each calculation, with the only change being where California and Illinois are ranked.

```{r number-of-facilities-by-company, echo = FALSE, message = FALSE, warning = FALSE}
tri_data %>% 
  select(standard_parent_co_name, parent_co_name, facility_name) %>% 
  group_by(standard_parent_co_name, parent_co_name) %>% 
  summarise(number_of_facilities = n_distinct(facility_name)) %>% 
  arrange(desc(number_of_facilities))
```

```{r number-of-facilities-by-state, echo = FALSE, message = FALSE, warning = FALSE}
tri_data %>% 
  group_by(state) %>% 
  count(state) %>% 
  arrange(desc(n))

tri_data %>% 
  select(facility_name, state) %>% 
  distinct(facility_name, state) %>% 
  group_by(state) %>%
  count(state) %>% 
  arrange(desc(n))
```

### Map of Facilities

The large majority of facilities in this dataset are located in North America, but a significant number of U.S.-owned facilities are strewn across the global map in other U.S. territories -- possibly shifting any inferences that can be made on the state of pollution solely in the U.S.

```{r facility-map, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "An interactive map displaying distinct U.S.-owned facility locations. Each point represents a facility and includes information such as facility name, parent company, industry sector, city, and state. 31,594 points are located in North America, and 127 are in other territories."}
tri_data %>% 
  distinct(longitude, latitude, facility_name, parent_co_name, industry_sector, city, state) %>% 
  leaflet() %>% 
  addTiles() %>% 
    addCircleMarkers(lng = ~longitude, 
                 lat = ~latitude, 
                 clusterOptions = markerClusterOptions(),
                 popup = ~paste0(facility_name, "<br>", parent_co_name, "<br>", industry_sector, "<br>", city, ", ", state))
```

### Percent of Facilities on Tribal Land

Though the percentage of facilities located on tribal land is less than 1% (there are `r sum(facility_location$tribal_yes_no == "YES")` facilities on tribal land), and we are curious about any differences in the amount of chemicals used and released on tribal vs not tribal land.

```{r percent-tribal-land, echo = FALSE, message = FALSE, warning = FALSE}
facility_location %>% 
  select(tribal_yes_no) %>% 
  group_by(tribal_yes_no) %>%
  summarise(percent = 100 * n()/nrow(facility_location))

facility_location %>% 
  select(tribal_yes_no) %>% 
  group_by(tribal_yes_no) %>% 
  count(tribal_yes_no)
```

Using these tables, we have set up a groundwork map for placing chemical usage, which leads us to ask: knowing the drastic difference in percent of facilities on tribal land or not, does the location of tribal land have any effect on the type and amount of chemical release when compared to facilities not on tribal land?

We can take points from history and U.S. law, knowing that tribes of the American West often do have significant health hazards due to the many power plants, factories, mines, waste dumps, and testing sites that are placed on their land -- sometimes with permission as a means to acquiring much-needed funds, and sometimes out of a tribe's power. This question will appear further in visualizations.

## Industry Analysis

Within these observations of location, there is the question of each facility's purpose. By condensing the purpose of a factory into just 10 categories, we made it easier to analyze their individual patterns of location, chemical use, and pollution. This allows us to ask: is there a correlation between industry sector and frequency of chemical use? Further, their frequency of specific types of chemicals -- carcinogens, PFAS', and PBT'?

```{r industry-sector-dataset, echo = FALSE, message = FALSE, warning = FALSE}
industry_info <- tri_data %>% 
  select(industry_sector, state, clean_air_act_chemical, carcinogen, metal_category, pbt, pfas, on_site_release_total, off_site_release_total, on_site_contained, off_site_contain) %>% 
  distinct(industry_sector, state, clean_air_act_chemical, carcinogen, metal_category, pbt, pfas, on_site_release_total, off_site_release_total, on_site_contained, off_site_contain)
```

```{r industry-sector-categories, echo = FALSE, message = FALSE, warning = FALSE}
tri_data <- tri_data %>% 
  mutate(industry_sector_category = case_when(industry_sector %in% c("Tobacco", "Beverages", "Food") ~ "Agriculture and Food Processing",
  industry_sector %in% c("Electrical Equipment", "Transportation Equipment", "Machinery", "Computers and Electronic     Products") ~ "Machinery and Technology",
  industry_sector %in% c("Miscellaneous Manufacturing", "Other") ~ "Misc",
  industry_sector %in% c("Chemicals", "Chemical Wholesalers", "Hazardous Waste") ~ "Chemicals and Waste",
  industry_sector %in% c("Leather", "Apparel", "Textiles", "Textile Product") ~ "Textiles and Leather",
  industry_sector %in% c("Petroleum Bulk Terminals", "Petroleum") ~ "Petroleum",
  industry_sector %in% c("Metal Mining", "Coal Mining") ~ "Mining",
  industry_sector %in% c("Nonmetallic Mineral Product", "Plastics and Rubber", "Fabricated Metals", "Primary Metals") ~ "Processed Materials",
  industry_sector %in% c("Furniture", "Wood Products", "Paper", "Printing", "Publishing") ~ "Wood and Paper",
  industry_sector %in% "Electric Utilities" ~ "Electric Utilities"))
```

### Industry Sector Distribution

The most common purpose of a U.S. facility is dealing with the production, waste, and wholesales of chemicals, accounting for almost 30% of U.S. industries as shown in the table. The least common accounting for about 0.4% is textile production, and we wonder if this is because of trends in American imports.

```{r industry-sector-category-distribution, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A bar plot visualizes the distribution of industry sector categories in the Toxic Release Inventory (TRI). The plot displays the count of different industry sectors, with each bar representing a specific category. Chemical waste is the most prevalent sector, and textiles the least."}

tri_data %>% 
 select(industry_sector_category) %>% 
 group_by(industry_sector_category) %>%
 summarise(percent = 100 * n()/nrow(tri_data)) %>% 
 arrange(desc(percent))

tri_data %>% 
  ggplot(aes(y = fct_infreq(industry_sector_category), fill = industry_sector_category)) +
  geom_bar() +
  labs(title = "Industry Sector Prevalence",
    subtitle = "Distribution of Industry Sector Categories in the TRI",
    x = "Count",
    y = "Industry Sector Category",
    fill = "Industry Sector Category") +
  theme_minimal() +
  scale_fill_viridis_d()
```

### Carcinogen Percentage by Industry Sector Graph

Understandably, fitting with the most common industry sector, the chemical-producing facilities (and processed materials) also use the most carcinogens (non-comprehensive), but the frequency seems to almost consistently grow with the prevalence of these sectors besides the food industry. That being said, every sector listed has a chemical usage that is majority non-carcinogenic.

```{r industry-sector-and-carcinogen-use, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A bar plot illustrates the distribution of carcinogen use across various industry sectors. Each bar represents an industry sector's prevalence, differentiated by the presence or absence of carcinogens, denoted by different fill colors. Every category uses mostly non-carcinogens, with the highest amount of carcinogens used in chemical and processing industries."}

tri_data %>% 
  ggplot(aes(y = fct_infreq(industry_sector_category), fill = carcinogen)) +
  geom_bar(position = "fill") +
  labs(title = "Carcinogen Use by Industry Sector",
       x = "Count",
       y = "Industry Sector",
       fill = "Carcinogenic") +
  theme_minimal() +
  scale_fill_viridis_d(begin = 0.4, end = 1)
```

## Chemical Analysis

Honing our observational questions down to just chemical trends of use and disposal now, we see how the laws of the EPA inform chemical procedures. Specifically in terms of the Clean Air Act, is there a differing correlation between the location and frequency of these specially-listed chemicals when compared to chemicals not listed on the Clean Air Act? And more broadly, is there any type, category, or closely-watched category of chemical that is most common despite the efforts of these laws? While these are all questions that we are interested in exploring, we found that many of them are beyond the scope of the information included in this dataset. 

```{r chemical-info-dataset, echo = FALSE, message = FALSE, warning = FALSE}
chemical_info <- tri_data %>% 
  select(year, chemical, elemental_metal_included, clean_air_act_chemical, metal, metal_category, carcinogen, pbt, pfas) %>% 
  arrange(chemical)
```

We found this table of the number of chemicals tracked each year very interesting, especially because we know that chemicals are added and taken out every year. We are curious about how these decisions are made and especially about the drop from 546 to 545 between 2020 and 2021, especially because EPA documentation shows that there were dozens of chemicals added to the TRI in 2020.

```{r chemical-count-by-year, echo = FALSE, message = FALSE, warning = FALSE}
tri_data %>% 
  select(chemical, year) %>% 
  distinct(chemical, year) %>% 
  group_by(year) %>%
  count(year) %>% 
  arrange(year)
```

The most commonly used chemical is lead, accounting for over 5% of use, followed by its compounds that make up almost 4% of use. Lead is known to cause poisoning of the human body, leading to neurological and reproductive health issues as well as impaired function of the kidneys and other body systems. Poisoning can be acquired through contaminated dust particles and products, contaminated drinking water, and contaminated soil.

```{r chemical-percent, echo = FALSE, message = FALSE, warning = FALSE}
chemical_info %>% 
  select(chemical) %>% 
  group_by(chemical) %>%
  summarise(percent = 100 * n()/nrow(chemical_info)) %>% 
  arrange(desc(percent))
```

### Chemical Categories

These calculations show the number of carcinogens, PFAS, and PBTs observed in this dataset. For additional detail and comprehension, we decided to create tibbles that listed each chemical and whether they are or aren't a carcinogen, PFAS, or PBT. 

There are `r sum(chemical_info$carcinogen == "YES")` carcinogens being observed -- a large number creating a small percentage.

```{r carcinogen-percent-yes, echo = FALSE, message = FALSE, warning = FALSE}
chemical_info %>% 
  select(chemical, carcinogen) %>% 
  filter(carcinogen == "YES") %>% 
  group_by(chemical)
```

There are `r sum(chemical_info$carcinogen == "NO")` non-carcinogens being observed.

```{r carcinogen-percent-no, echo = FALSE, message = FALSE, warning = FALSE}
chemical_info %>% 
  select(chemical, carcinogen) %>% 
  filter(carcinogen == "NO") %>% 
  group_by(chemical)
```

There are `r sum(chemical_info$pfas == "YES")` observations of PFAS chemicals in the dataset.

```{r pfas-percent-yes, echo = FALSE, message = FALSE, warning = FALSE}
chemical_info %>% 
  select(chemical, pfas) %>% 
  filter(pfas == "YES") %>% 
  group_by(chemical)
```

There are `r sum(chemical_info$pfas == "NO")` observations of non-PFAS chemicals in the dataset.

```{r pfas-percent-no, echo = FALSE, message = FALSE, warning = FALSE}
chemical_info %>% 
  select(chemical, pfas) %>% 
  filter(pfas == "NO") %>% 
  group_by(chemical)
```

There are `r sum(chemical_info$pbt == "YES")` observations of PBT chemicals in the dataset.

```{r pbt-percent-yes, echo = FALSE, message = FALSE, warning = FALSE}
chemical_info %>% 
  select(chemical, pbt) %>% 
  filter(pbt == "YES") %>% 
  group_by(chemical)
```

There are `r sum(chemical_info$pbt == "NO")` observations of non-PBT chemicals in the dataset.

```{r pbt-percent-no, echo = FALSE, message = FALSE, warning = FALSE}
chemical_info %>% 
  select(chemical, pbt) %>% 
  filter(pbt == "NO") %>% 
  group_by(chemical)
```

### Chemical Category Calculations


The large majority of chemicals used are not elemental metals or metals in general. About 63% are identified in the Clean Air Act, leaving 37% not present. Over 28% of chemicals used in these facilities are known to be carcinogenic, 17% are PBTs, and 0.02% are PFAS'. These smaller percentages are still a concern, and are in-part new variables to track. PFAS did not have to be reported to the TRI until 2020 (making this decade of data insufficient), even though over 2,000 facilities were known to be producing them before the regulation. Therefore, it has far fewer observations in comparison to other chemicals though used since the 1940s and known to cause certain cancers, impairment of the immune system, reproductive issues, and abnormal developmental effects. The reporting threshold for that particular subset of chemicals is 100 pounds per year.

For the visualizations below: elemental metals (some harmless, some causing neurotoxicity) keep a near-consistent distribution in the chemical data. The few increases this type of metal makes in the data is adjusted by the many additions of tracked chemicals in the dataframe, also causing the count for non-elemental-metals to increase. A similar state of increase goes for the amount of Clean Air Act chemicals and their growing amendments (still with more Clean Air Act chemicals than not) and with the general metals graph (more non-metals than metals, though both counts increasing). The amount of PBTs remains consistent with the non-PBTs increasing with new variables, and our two years of PFAS data show their consistency -- though, of course, not much judgement can be made through this small piece of information, and the same must go for much of these environmentally-altered graphs.

```{r chemical-percent-elemental-metal-included, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A grouped bar plot displays the prevalence of elemental metals used in U.S. facilities categorized by year from 2011 to 2021. Each bar represents the count of elemental metals with distinct colors indicating whether the chemicals used are or are not elemental metals. The large majority are not elemental metals, but the amount of elemental metals counted has been increasing slightly by year."}

chemical_info %>% 
  select(elemental_metal_included) %>% 
  group_by(elemental_metal_included) %>%
  summarise(percent = 100 * n()/nrow(chemical_info)) %>% 
  arrange(desc(percent))

tri_data %>% 
  select(year, elemental_metal_included, clean_air_act_chemical, metal, metal_category, carcinogen, pbt, pfas) %>%
  distinct(year, elemental_metal_included, clean_air_act_chemical, metal, metal_category, carcinogen, pbt, pfas) %>% 
  ggplot(aes(x = elemental_metal_included, fill = elemental_metal_included)) +
  geom_bar() +
  labs(title = "Elemental Metal Prevalence by Year",
       x = "Elemental Metal",
       y = "Count",
       fill = "Elemental Metal") +
  theme_minimal() +
  coord_flip() +
  scale_fill_viridis_d(begin = 0.4, end = 1) +
  facet_wrap(~year)
```

```{r chemical-percent-clean-air-act, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A grouped bar plot displays the prevalence of Clean Air Act chemicals used in U.S. facilities categorized by year from 2011 to 2021. Each bar represents the count of chemicals with distinct colors indicating whether they are or are not identified in the Clean Air Act. The large majority are in the act, but the amount of non-act chemicals counted has been increasing slightly by year."}
chemical_info %>% 
  select(clean_air_act_chemical) %>% 
  group_by(clean_air_act_chemical) %>%
  summarise(percent = 100 * n()/nrow(tri_data)) %>% 
  arrange(desc(percent))

chemical_info %>% 
  select(year, elemental_metal_included, clean_air_act_chemical, metal, metal_category, carcinogen, pbt, pfas) %>% 
  distinct(year, elemental_metal_included, clean_air_act_chemical, metal, metal_category, carcinogen, pbt, pfas) %>% 
  ggplot(aes(x = clean_air_act_chemical, fill = clean_air_act_chemical)) +
  geom_bar() +
  labs(title = "Clean Air Act Chemical Prevalence by Year",
       x = "Clean Air Act Chemical", 
       y = "Count",
       fill = "Clean Air Act Chemical") +
  theme_minimal() +
  coord_flip() +
  scale_fill_viridis_d(begin = 0.4, end = 1) +
  facet_wrap(~year)
```

```{r chemical-percent-metal, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A grouped bar plot displays the prevalence of metals used in U.S. facilities categorized by year from 2011 to 2021. Each bar represents the count of metals with distinct colors indicating whether the chemicals used are or are not metals. Most of them are not metals, and the amount of metals and non-metals counted has been increasing by year."}
chemical_info %>% 
  select(metal) %>% 
  group_by(metal) %>%
  summarise(percent = 100 * n()/nrow(tri_data)) %>% 
  arrange(desc(percent))

tri_data %>%
  select(year, elemental_metal_included, clean_air_act_chemical, metal, metal_category, carcinogen, pbt, pfas) %>% 
  distinct(year, elemental_metal_included, clean_air_act_chemical, metal, metal_category, carcinogen, pbt, pfas) %>% 
  ggplot(aes(x = metal, fill = metal)) +
  geom_bar() +
  labs(title = "Metal Prevalence by Year",
       x = "Metal",
       y = "Count",
       fill = "Metal") +
  theme_minimal() +
  coord_flip() +
  scale_fill_viridis_d(begin = 0.4, end = 1) +
  facet_wrap(~year) 
```

```{r chemical-percent-metal-category, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = c("Plot 1 is a faceted bar plot depicts the prevalence of metal categories used by U.S. facilities from 2011 to 2021, whether a non-metal, metal with qualifiers, metal compound, chemical possibly containing metal, indivudually-listed metal compound, or elemental metal. Each bar represents the count of these metal categories, sorted by year, with varied colors denoting distinct metal category types", "Plot 2 is a circular pie chart demonstrates the distribution of metal categories used by U.S. facilities in the dataset. Each segment of the pie represents a metal category with distinct colors, with the size proportional to the percentage of occurances. Non-metals make up 54% of the chart, and elemental metals make up 19% of the chart")}
chemical_info %>% 
  select(metal_category) %>% 
  group_by(metal_category) %>%
  summarise(percent = 100 * n()/nrow(tri_data)) %>% 
  arrange(desc(percent))

chemical_info %>%
  select(year, elemental_metal_included, clean_air_act_chemical, metal, metal_category, carcinogen, pbt, pfas) %>%
  distinct(year, elemental_metal_included, clean_air_act_chemical, metal, metal_category, carcinogen, pbt, pfas) %>%
  ggplot(aes(x = metal_category, fill = metal_category)) +
  geom_bar() +
  labs(title = "Metal Category Prevalence by Year",
       x = "Metal Category",
       y = "Count",
       fill = "Metal Category") +
  theme_minimal() +
  coord_flip() +
  scale_fill_viridis_d() +
  facet_wrap(~year)

tri_data %>% 
  group_by(metal_category) %>% 
  summarise(prop = n()/nrow(tri_data)) %>% 
  ggplot(aes(x = "", y = prop, fill = fct_inorder(metal_category))) +
  geom_col(color = "white", linewidth = .3) +
  geom_text(aes(x = "", y = prop, label = round(prop, 2)), position = position_stack(vjust = 0.5)) +
  labs(title = "Metal Category Distribution",
       x = "",
       y = "", 
       fill = "Metal Category") +
  theme_void() +
  coord_polar(theta = "y") +
  scale_fill_viridis_d(begin = 0.4, end = 0.9)
```

```{r chemical-trends-by-category-carcinogen, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A grouped bar plot shows the prevalence of carcinogens used in U.S. facilities categorized by year from 2011 to 2021. Each bar represents the count of carcinogenic substances, sorted by year, with varied colors indicating different carcinogen categories. The majority of chemicals used are non-carcinogenic."}
chemical_info %>% 
  select(carcinogen) %>% 
  group_by(carcinogen) %>%
  summarise(percent = 100 * n()/nrow(chemical_info)) %>% 
  arrange(desc(percent))

chemical_info %>% 
  select(year, elemental_metal_included, clean_air_act_chemical, metal, metal_category, carcinogen, pbt, pfas) %>% 
  distinct(year, elemental_metal_included, clean_air_act_chemical, metal, metal_category, carcinogen, pbt, pfas) %>% 
  ggplot(aes(x = carcinogen, fill = carcinogen)) +
  geom_bar() +
  labs(title = "Carcinogen Prevalence by Year",
       x = "Carcinogenic",
       y = "Count",
       fill = "Carcinogenic") +
  theme_minimal() +
  coord_flip() +
  scale_fill_viridis_d(begin = 0.4, end = 1) +
  facet_wrap(~year) 
```

```{r chemical-trends-by-category-pbt, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A grouped bar plot shows the prevalence of PBTs used in U.S. facilities categorized by year from 2011 to 2021. Each bar represents the count of PBT substances, sorted by year, with different colors indicating whether a chemical is or is not a PBT. The large majority of chemicals used are non-PBTs, with the number of PBTs being relatively consistent by year."}
chemical_info %>% 
  select(pbt) %>% 
  group_by(pbt) %>%
  summarise(percent = 100 * n()/nrow(chemical_info)) %>% 
  arrange(desc(percent))

chemical_info %>% 
  select(year, elemental_metal_included, clean_air_act_chemical, metal, metal_category, carcinogen, pbt, pfas) %>% 
  distinct(year, elemental_metal_included, clean_air_act_chemical, metal, metal_category, carcinogen, pbt, pfas) %>% 
  ggplot(aes(x = pbt, fill = pbt)) +
  geom_bar() +
  labs(title = "PBT Prevalence by Year",
       x = "PBT",
       y = "Count",
       fill = "PBT") +
  theme_minimal() +
  coord_flip() +
  scale_fill_viridis_d(begin = 0.4, end = 1) +
  facet_wrap(~year) 
```

```{r chemical-trends-by-category-pfas, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A grouped bar plot shows the prevalence of PFAS chemicals used in U.S. facilities categorized by year from 2011 to 2021. Each bar represents the count of PFAS substances, sorted by year, with different colors indicating whether a chemical is or is not a PFAS. The overarching majority of chemicals used are not PFAS, and PFAS data only appears for the years 2020 and 2021."}
chemical_info %>% 
  select(pfas) %>% 
  group_by(pfas) %>%
  summarise(percent = 100 * n()/nrow(chemical_info)) %>% 
  arrange(desc(percent))

chemical_info %>% 
  select(year, elemental_metal_included, clean_air_act_chemical, metal, metal_category, carcinogen, pbt, pfas) %>% 
  distinct(year, elemental_metal_included, clean_air_act_chemical, metal, metal_category, carcinogen, pbt, pfas) %>% 
  ggplot(aes(x = pfas, fill = pfas)) +
  geom_bar() +
  labs(title = "PFAS Prevalence by Year",
       x = "PFAS",
       y = "Count",
       fill = "PFAS") +
  theme_minimal() +
  coord_flip() +
  scale_fill_viridis_d(begin = 0.4, end = 1) +
  facet_wrap(~year) 
```


## Pollution analysis

From these distributions of observed chemicals, there is still the question of their disposal after use. With air, ground, and water being some possible points of disposal, we must assess the trends in these differing types of waste removal. In the past decade, what are these trends in pollution due to chemical release, whether on-site or off?

```{r pollution-info-dataset, echo = FALSE, message = FALSE, warning = FALSE}
pollution_info <- tri_data %>% 
  select(year, fugitive_air, stack_air, water, underground, underground_class_1, underground_class_2_through_5, landfills, land_treatment, surface_impoundment, other_disposal, on_site_release_total, public_treatment_total_transfer, off_site_release_total, off_site_recycled_total, off_site_energy_recovery_total, off_site_treated_total, total_transfer, total_releases, releases, on_site_contained, on_site_other, off_site_contain, off_site_other)
```

### On-Site Pollution by Category

We created graphs for each of the on-site release types, however, `Underground`, `Landfill`, and `Surface Impoundment` are entirely zeros so we did not create plots of them. 

```{r pollution-by-on-site-release-fugitive-air, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A smoothed scatter plot visualizes the relationship between fugitive air releases and on-site release totals of chemicals used in U.S. facilities from 2011 to 2021. Each point represents a data observation, and most years show a steep decline in fugitive air release with larger on-site release."}
pollution_info %>% 
  ggplot(aes(x = on_site_release_total, y = fugitive_air, color = fugitive_air, fill = fugitive_air)) + 
  geom_smooth(color = "#00608E", linewidth = 0.6) +
  labs(title = "Fugitive Air Release by Year",
       x = "On Site Release Total",
       y = "Fugitive Air") +
  theme_minimal() +
  facet_wrap(~ year)
```

```{r pollution-by-on-site-release-stack-air, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A smoothed scatter plot visualizes the relationship between stack air releases and on-site release totals of chemicals used in U.S. facilities from 2011 to 2021. Each point represents a data observation, and most years show a steep decline in stack air release with larger on-site release."}
pollution_info %>% 
  ggplot(aes(x = on_site_release_total, y = stack_air)) +
  geom_smooth(color = "#00608E", linewidth = 0.6) +
  labs(title = "Stack Air Release by Year",
       x = "On Site Release Total",
       y = "Stack Air") +
  theme_minimal() +
  facet_wrap(~ year)
```

```{r pollution-by-on-site-release-water, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A smoothed scatter plot visualizes the relationship between water releases and on-site release totals of chemicals used in U.S. facilities from 2011 to 2021. Each point represents a data observation, and most years show a steep decline in water release with larger on-site release."}
pollution_info %>% 
  ggplot(aes(x = on_site_release_total, y = water)) +
  geom_smooth(color = "#00608E", linewidth = 0.6) +
  labs(title = "Water Release by Year",
       x = "On Site Release Total",
       y = "Water") +
  theme_minimal() +
  facet_wrap(~ year)
```

```{r pollution-by-on-site-release-underground-class-1, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A smoothed scatter plot visualizes the relationship between underground (Class 1) releases and on-site release totals of chemicals used in U.S. facilities from 2011 to 2021. Each point represents a data observation, and most years show a steep decline in underground (Class 1) release with larger on-site release."}
 pollution_info %>% 
  ggplot(aes(x = on_site_release_total, y = underground_class_1)) +
  geom_smooth(color = "#00608E", linewidth = 0.6) +
  labs(title = "Underground Class 1 Releases by Year",
       x = "On Site Release Total",
       y = "Underground Class 1") +
  theme_minimal() +
  facet_wrap(~ year)
```

```{r pollution-by-on-site-release-underground-class-2-to-5, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A smoothed scatter plot visualizes the relationship between underground (Class 2-5) releases and on-site release totals of chemicals used in U.S. facilities from 2011 to 2021. Each point represents a data observation, and most years show a consistently straight line of underground (Class 2-5) release even with larger on-site release."}
pollution_info %>% 
  ggplot(aes(x = on_site_release_total, y = underground_class_2_through_5)) +
  geom_smooth(color = "#00608E", linewidth = 0.6) +
  labs(title = "Underground Class 2 Through 5 Release by Year",
       x = "On Site Release Total",
       y = "Underground Class 2 Through 5") +
  theme_minimal() +
  facet_wrap(~ year)
```

```{r pollution-by-on-site-release-land-treatment, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A smoothed scatter plot visualizes the relationship between land treatment and on-site release totals of chemicals used in U.S. facilities from 2011 to 2021. Each point represents a data observation, and most years show a small decline in land treatment with larger on-site release."}
pollution_info %>% 
  ggplot(aes(x = on_site_release_total, y = land_treatment)) +
  geom_smooth(color = "#00608E", linewidth = 0.6) +
  labs(title = "Land Treatment by Year",
       x = "On Site Release Total",
       y = "Land Treatment") +
  theme_minimal() +
  facet_wrap(~ year)
```

```{r pollution-by-on-site-release-other-disposal, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A smoothed scatter plot visualizes the relationship between other disposal and on-site release totals of chemicals used in U.S. facilities from 2011 to 2021. Each point represents a data observation, and all years show a steep increase in other release with larger on-site release."}
pollution_info %>% 
  ggplot(aes(x = on_site_release_total, y = other_disposal)) +
  geom_smooth(color = "#00608E", linewidth = 0.6) +
  labs(title = "Other Disposal by Year",
       x = "On Site Release Total",
       y = "Other Disposal") +
  theme_minimal() +
  facet_wrap(~ year)
```

### Pollution by General Category (Including On-site-total)

We also decided to create graphs of the other pollution and release types, including the on site total. The `Releases` column is also all zeros, so it was not included in any of the visualizations. 

```{r pollution-by-general-category, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A line plot visualizes the trend in on-site release totals of chemicals from U.S. facilities from 2011 to 2021. The line represents a smoothed curve depicting the change in on-site releases over the specified period. The on-site releases slowly decline over the decade."}
pollution_info %>% 
  ggplot(aes(x = year, y = on_site_release_total)) + 
  geom_smooth(fill = "#00A790", color = "#00608E", linewidth = 0.6) +
  labs(title = "On Site Release Total by Year",
       x = "Year",
       y = "On Site Release Total") +
  theme_minimal()
```

```{r pollution-public-treatment-total-transfer, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A line plot visualizes the trend in public treatment transfer totals of chemicals from U.S. facilities from 2011 to 2021. The line represents a smoothed curve depicting the change in these transfers over the specified period. The public treatment transfers slowly increase over the decade."}
pollution_info %>% 
  ggplot(aes(x = year, y = public_treatment_total_transfer)) + 
  geom_smooth(fill = "#00A790", color = "#00608E", linewidth = 0.6) +
  labs(title = "Total Transfer to Public Treatment by Year",
       x = "Year",
       y = "Total Transfer to Public Treatment") +
  theme_minimal()
```

```{r pollution-off-site-release-total, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A line plot visualizes the trend in off-site release totals of chemicals from U.S. facilities from 2011 to 2021. The line represents a smoothed curve depicting the change in these releases over the specified period. The off-site release totals decrease over the decade."}
pollution_info %>% 
  ggplot(aes(x = year, y = off_site_release_total)) + 
  geom_smooth(fill = "#00A790", color = "#00608E", linewidth = 0.6) +
  labs(title = "Off Site Release Total by Year",
       x = "Year",
       y = "Off Site Release Total") +
  theme_minimal()
```

```{r pollution-off-site-recycled-total, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A line plot visualizes the trend in off-site recycled totals of chemicals from U.S. facilities from 2011 to 2021. The line represents a smoothed curve depicting the change in these releases over the specified period. The off-site recycled totals only slightly increase by the end of the decade."}
pollution_info %>% 
  ggplot(aes(x = year, y = off_site_recycled_total)) + 
  geom_smooth(fill = "#00A790", color = "#00608E", linewidth = 0.6) +
  labs(title = "Total Recycled Off Site by Year",
       x = "Year",
       y = "Total Recycled Off Site") +
  theme_minimal()
```

```{r pollution-off-site-energy-recovery-total, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A line plot visualizes the trend in off-site energy recovery totals of chemicals from U.S. facilities from 2011 to 2021. The line represents a smoothed curve depicting the change in these energy recoveries over the specified period. The recovery totals drastically increase by the end of the decade."}
pollution_info %>% 
  ggplot(aes(x = year, y = off_site_energy_recovery_total)) + 
  geom_smooth(fill = "#00A790", color = "#00608E", linewidth = 0.6) +
  labs(title = "Total Energy Recovery Off Site by Year",
       x = "Year",
       y = "Total Energy Recovery Off Site") +
  theme_minimal()
```

```{r pollution-off-site-treated-total, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A line plot visualizes the trend in off-site treated totals of chemicals from U.S. facilities from 2011 to 2021. The line represents a smoothed curve depicting the change in these treated totals over the specified period. The off-site treated totals decrease by the end of the decade."}
pollution_info %>% 
  ggplot(aes(x = year, y = off_site_treated_total)) + 
  geom_smooth(fill = "#00A790", color = "#00608E", linewidth = 0.6) +
  labs(title = "Total Treated Off Site by Year",
       x = "Year",
       y = "Total Treated Off Site") +
  theme_minimal()
```

```{r pollution-total-transfer, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A line plot visualizes the trend in transfer totals of chemicals from U.S. facilities from 2011 to 2021. The line represents a smoothed curve depicting the change in these transfers over the specified period. The transfer totals increase by the end of the decade."}
pollution_info %>% 
  ggplot(aes(x = year, y = total_transfer)) + 
  geom_smooth(fill = "#00A790", color = "#00608E", linewidth = 0.6) +
  labs(title = "Total Transfered by Year",
       x = "Year",
       y = "Total Transfered") +
  theme_minimal()
```

```{r pollution-total-releases, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A line plot visualizes the trend in total releases of chemicals from U.S. facilities from 2011 to 2021. The line represents a smoothed curve depicting the change in these releases over the specified period. The total releases decrease over the decade."}
pollution_info %>% 
  ggplot(aes(x = year, y = total_releases)) + 
  geom_smooth(fill = "#00A790", color = "#00608E", linewidth = 0.6) +
  labs(title = "Total Released by Year",
       x = "Year", 
       y = "Total Released")
```

```{r pollution-on-site-contained, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A line plot visualizes the trend in chemicals contained on-site from U.S. facilities from 2011 to 2021. The line represents a smoothed curve depicting the change in these containments over the specified period. The total of on-site contained chemicals somewhat decrease over the decade."}
pollution_info %>% 
  ggplot(aes(x = year, y = on_site_contained)) + 
  geom_smooth(fill = "#00A790", color = "#00608E", linewidth = 0.6) +
  labs(title = "Amount Contained On Site By Year",
       x = "Year",
       y = "Amount Contained On Site") +
  theme_minimal()
```

```{r pollution-on-site-other, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A line plot visualizes the trend in total on-site other disposal of chemicals from U.S. facilities from 2011 to 2021. The line represents a smoothed curve depicting the change in these disposals over the specified period. The total on-site disposals decrease consistently over the decade."}
pollution_info %>% 
  ggplot(aes(x = year, y = on_site_other)) + 
  geom_smooth(fill = "#00A790", color = "#00608E", linewidth = 0.6) +
  labs(title = "On Site 'Other' by Year",
       x = "Year",
       y = "On Site 'Other'") +
  theme_minimal()
```

```{r pollution-off-site-contain, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A line plot visualizes the trend in chemicals contained off-site from U.S. facilities from 2011 to 2021. The line represents a smoothed curve depicting the change in these containments over the specified period. The total of off-site contained chemicals decrease over the decade."}
pollution_info %>% 
  ggplot(aes(x = year, y = off_site_contain)) + 
  geom_smooth(fill = "#00A790", color = "#00608E", linewidth = 0.6) +
  labs(title = "Contained Off Site by Year",
       x = "Year",
       y = "Contained Off Site") +
  theme_minimal()
```

```{r pollution-off-site-other, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A line plot visualizes the trend in total off-site other disposal of chemicals from U.S. facilities from 2011 to 2021. The line represents a smoothed curve depicting the change in these disposals over the specified period. The total off-site other disposals remain virtually consistent over the decade."}
pollution_info %>% 
  ggplot(aes(x = year, y = off_site_other)) + 
  geom_smooth(fill = "#00A790", color = "#00608E", linewidth = 0.6) +
  labs(title = "Off Site 'Other' by Year",
       x = "Year",
       y = "Off Site 'Other'") +
  theme_minimal()
```

```{r industry-sector-category-water-release, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A grouped bar plot illustrates the water release across various industry sector categories for facilities in the U.S from 2011 to 2021. Each bar represents the quantity of water released, with distinct colors indicating different industry sector categories. Agriculture and food processing has the most water release of all industry sectors, and machinery has none."}
tri_data %>% 
  ggplot(aes(y = industry_sector_category, x = water, fill = industry_sector_category)) +
  geom_col() +
  labs(title = "Water Release by Industry Sector Category",
       x = "Water",
       y = "Industry Sector Category",
       fill = "Industry Sector Category") +
  theme_minimal() +
  scale_fill_viridis_d()
```

# Detailed Analysis

We elected to select 11 chemicals that include a mix of carcinogens, PBTs, clean air act chemicals, and metals for a more detailed analysis. This allowed us to create more specific pollution and release graphs, as well as create visualizations for the prevalence of these chemicals on tribal lands. We also looked at how many of these chemicals are used in each state, and found that 28 states have used all 11 chemicals between 2011 and 2021. It is important to note that we chose phosphorus because we find it to be an intriguing chemical (it is only manufactured at reportable levels in one facility), however, because it is infrequently used, it did not show up in many of our analyses. 

```{r create-analysis-data-frame, echo = FALSE, message = FALSE, warning = FALSE}
chemical_analysis_data <- tri_data %>% 
  filter(chemical %in% c("Arsenic", "Styrene", "Formaldehyde", "Nickel", "Chromium", "Lead", "Mercury", "Ammonia", "Phosphorus (yellow or white)", "Chloroform", "Benzo[g,h,i]perylene")) 

chemical_analysis_data <- chemical_analysis_data %>%
  mutate(off_site_total = off_site_release_total + off_site_recycled_total + off_site_energy_recovery_total + public_treatment_total_transfer + off_site_treated_total + total_transfer + off_site_contain + off_site_other)

chemical_analysis_data <- chemical_analysis_data %>% 
  mutate(on_site_total = fugitive_air + stack_air + water + underground + underground_class_1 + underground_class_2_through_5 + landfills + land_treatment + surface_impoundment + other_disposal + on_site_release_total + on_site_contained + on_site_other)
```

## Chemicals and Location

```{r count-chemical-and-type, echo = FALSE, message = FALSE, warning = FALSE}
chemical_analysis_data %>% 
  count(chemical) %>% 
  arrange(desc(n))

chemical_analysis_data %>% 
  select(chemical, pfas, pbt, clean_air_act_chemical, carcinogen) %>% 
  group_by(chemical) %>% 
  count(pfas, pbt, clean_air_act_chemical, carcinogen) %>% 
  arrange(desc(n))
```

```{r chemical-use-by-facility, echo = FALSE, message = FALSE, warning = FALSE}
chemical_analysis_data %>% 
  select(standard_parent_co_name, parent_co_name, facility_name, chemical) %>% 
  group_by(standard_parent_co_name, parent_co_name, facility_name) %>% 
  summarise(number_of_chemicals = n_distinct(chemical)) %>% 
  arrange(desc(number_of_chemicals))
```

```{r chemical-use-on-tribal-lands, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A grouped bar plot followed by a stacked bar plot visualizes the proportion of chemical use categorized by its presence on and off tribal lands from 2011 to 2021. Each bar segment represents the proportion of a chemical whether on or off tribal land, with color representing the specific chemical. Nickel, mercury, formaldehyde, chromium, chloroform, benzo[g,h,i]perylene, and arsenic are more apparent on tribal land than off. Phosphorus is not used at all on tribal land."}
chemical_analysis_data %>% 
  group_by(tribal_yes_no, chemical) %>% 
  summarise(n = n()) %>% 
  mutate(prop = n/sum(n)) %>% 
  ggplot(aes(x = chemical, y = prop, fill = tribal_yes_no)) +
  geom_col(position = "fill") +
  labs(title = "Chemical Use On and Off Tribal Lands",
       subtitle = "By Chemical",
       x = "Chemical",
       y = "Proportion",
       fill = "Chemical") +
  theme_minimal() +
  coord_flip() +
  scale_fill_viridis_d(begin = 0.4, end = 1)

chemical_analysis_data %>% 
  select(chemical, tribal_yes_no) %>% 
  count(chemical, tribal_yes_no)

chemical_analysis_data %>% 
  ggplot(aes(y = tribal_yes_no, fill = chemical)) +
  geom_bar(position = "fill", color = "white") +
  labs(title = "Chemical Use On and Off Tribal Lands",
       subtitle = "By Tribal and Not Tribal Land",
       y = "Tribal Land?",
       x = "",
       fill = "Tribal Land?") +
  theme_minimal() +
  scale_fill_viridis_d()
```

```{r chemical-use-by-state, echo = FALSE, message = FALSE, warning = FALSE}
chemical_analysis_data %>%
  select(state, chemical) %>%
  group_by(state) %>%
  summarise(chemical_use = n_distinct(chemical)) %>%
  arrange(desc(chemical_use))
```

### Overview graphs

## Chemical Release Graphs

We created several chemical release graphs to help us further understand the pollution trends of the 11 chemicals we chose. This allowed us to visualize each of the chemicals by on site release type, off site disposal type, and off site disposal type by year and industry sector category. 

```{r chemical-category-graphs, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = c("For plot 1, a bar plot illustrates the frequency of eleven different chemicals used in U.S. faciltiies from 2011 to 2021 categorized by whether or not they are persistent, bioaccumulative, and toxic (PBT). Each bar represents a chemical, and the color distinction indicates whether the chemical falls under the PBT classification. Three of the eleven chosen chemicals are PBTs, and lead is the most commonly used PBT.", "For plot 2, a bar plot illustrates the frequency of eleven different chemicals used in U.S. faciltiies from 2011 to 2021 by whether or not they are categorized as PFAS. Each bar represents a chemical, and the color distinction indicates whether the chemical falls under the PFAS classification. None of the chosen chemicals are PFAS.", "For plot 3, a bar plot illustrates the frequency of eleven different chemicals used in U.S. faciltiies from 2011 to 2021 by whether or not they are categorized as carcinogenic. Each bar represents a chemical, and the color distinction indicates whether the chemical falls under the carcinogen classification. Six of the eleven chosen chemicals are carcinogens, with lead being the most commonly used carcinogen.", "For plot 4, a bar plot illustrates the frequency of eleven different chemicals used in U.S. faciltiies from 2011 to 2021 by whether or not they are classified as Clean Air Act chemicals. Each bar represents a chemical, and the color distinction indicates whether the chemical falls under the Act classification. Ammonia and lead are the only non-act chemicals in the chosen selection.")}

chemical_analysis_data %>% 
  ggplot(aes(y = fct_infreq(chemical), fill = pbt)) +
  geom_bar() +
  labs(title = "Is This Chemical a PBT?",
       y = "Chemical",
       fill = "PBT") +
  theme_minimal() +
  scale_fill_viridis_d(begin = 0.4, end = 1)

chemical_analysis_data %>% 
  ggplot(aes(y = fct_infreq(chemical), fill = pfas)) +
  geom_bar() +
  labs(title = "Is This Chemical a PFAS?",
       y = "Chemical",
       fill = "PFAS") +
  theme_minimal() +
  scale_fill_viridis_d(begin = 0.4, end = 1)

chemical_analysis_data %>% 
  ggplot(aes(y = fct_infreq(chemical), fill = carcinogen)) +
  geom_bar() +
  labs(title = "Is This Chemical Carcinogenic?",
       y = "Chemical",
       fill = "Carcinogenic") +
  theme_minimal() +
  scale_fill_viridis_d(begin = 0.4, end = 1)

chemical_analysis_data %>% 
  ggplot(aes(y = fct_infreq(chemical), fill = clean_air_act_chemical)) +
  geom_bar() +
  labs(title = "Is This Chemical Included in the Clean Air Act?",
       y = "Chemical",
       fill = "Clean Air Act Chemical?") +
  theme_minimal() +
  scale_fill_viridis_d(begin = 0.4, end = 1)
```

### Graphs of on-site release by type

These plots allowed us to visualize the trends in on site releases. From this dataset, Ammonia has very high rates of on-site-release, and we are curious to know if that is because of its frequency of use, the type of chemical that it is, or the ways it is used. 

```{r plot-fugitive-air-release-by-chemical, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A scatter plot of 11 chemicals used in U.S. facilities from 2011 to 2021 faceted by chemical. The x axis is the on site release total and the y axis is futitive air release. Based on the visualization, Ammonia has the most fugitive air release of the 11 chemicals."}

chemical_analysis_data %>% 
  ggplot(aes(x = on_site_release_total, y = fugitive_air)) +
  geom_point(aes(alpha = 0.3, color = chemical)) +
  labs(title = "Fugitive Air in On Site Release Total",
       x = "On Site Release Total",
       y = "Fugitive Air",
       color = "Chemical",
       alpha = "Saturation") +
  theme_minimal() +
  scale_color_viridis_d() +
  scale_fill_viridis_d() +
  facet_wrap(~ chemical)
```

```{r plot-stack-air-release-by-chemical, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A scatter plot of 11 chemicals used in U.S. facilities from 2011 to 2021 faceted by chemical. The x axis is the on site release total and the y axis is stack air release. Based on the visualization, Ammonia has the most stack air release of the 11 chemicals."}

chemical_analysis_data %>% 
  ggplot(aes(x = on_site_release_total, y = stack_air)) +
  geom_point(aes(alpha = 0.3, color = chemical)) +
  labs(title = "Stack Air in On Site Release Total",
       x = "On Site Release Total",
       y = "Stack Air",
       color = "Chemical",
       alpha = "Saturation") +
  theme_minimal() +
  scale_color_viridis_d() +
  scale_fill_viridis_d() +
  facet_wrap(~ chemical)
```

```{r plot-water-release-by-chemical, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A scatter plot of 11 chemicals used in U.S. facilities from 2011 to 2021 faceted by chemical. The x axis is the on site release total and the y axis is water release. Based on this visualization, Ammonia has the most water release of the 11 chemicals."}

chemical_analysis_data %>% 
  ggplot(aes(x = on_site_release_total, y = water)) +
  geom_point(aes(alpha = 0.3, color = chemical)) +
  labs(title = "Water in On Site Release Total",
       x = "On Site Release Total",
       y = "Water",
       color = "Chemical",
       alpha = "Saturation") +
  theme_minimal() +
  scale_color_viridis_d() +
  scale_fill_viridis_d() +
  facet_wrap(~ chemical)
```

```{r plot-underground-class-1-release-by-chemical, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A scatter plot of 11 chemicals used in U.S. facilities from 2011 to 2021 faceted by chemical. The x axis is the on site release total and the y axis is underground class 1 releases. Based on this visualization, Ammonia and Formaldehyde have the most underground class 1 release."}
chemical_analysis_data %>% 
  ggplot(aes(x = on_site_release_total, y = underground_class_1)) +
  geom_point(aes(alpha = 0.3, color = chemical)) +
  labs(title = "Underground Class 1 in On Site Release Total",
       x = "On Site Release Total",
       y = "Underground Class 1",
       color = "Chemical",
       alpha = "Saturation") +
  theme_minimal() +
  scale_color_viridis_d() +
  scale_fill_viridis_d() +
  facet_wrap(~ chemical)
```

```{r plot-underground-2-to-5-release-by-chemical, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A scatter plot of 11 chemicals used in U.S. facilities from 2011 to 2021 faceted by chemical. The x axis is the on site release total and the y axis is releases from underground classes 2 through 5. Based on this visualization, Ammonia has the most underground classes 2 through 5 releases."}
chemical_analysis_data %>% 
  ggplot(aes(x = on_site_release_total, y = underground_class_2_through_5)) +
  geom_point(aes(alpha = 0.3, color = chemical)) +
  labs(title = "Underground Class 2 through 5 in On Site Release Total",
       x = "On Site Release Total",
       y = "Underground Class 2 through 5",
       color = "Chemical",
       alpha = "Saturation") +
  theme_minimal() +
  scale_color_viridis_d() +
  scale_fill_viridis_d() +
  facet_wrap(~ chemical)
```

```{r plot-land-treatment-by-chemical, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A scatter plot of 11 chemicals used in U.S. facilities from 2011 to 2021 faceted by chemical. The x axis is the on site release total and the y axis is land treatment. Based on this visualization, Ammonia has the most land treatment."}
chemical_analysis_data %>% 
  ggplot(aes(x = on_site_release_total, y = land_treatment)) +
  geom_point(aes(alpha = 0.3, color = chemical)) +
  labs(title = "Land Treatment in On Site Release Total",
       x = "On Site Release Total",
       y = "Land Treatment",
       color = "Chemical",
       alpha = "Saturation") +
  theme_minimal() +
  scale_color_viridis_d() +
  scale_fill_viridis_d() +
  facet_wrap(~ chemical)
```

```{r plot-other-disposal-by-chemical, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A scatter plot of 11 chemicals used in U.S. facilities from 2011 to 2021 faceted by chemical. The x axis is the on site release total and the y axis is other disposal. Based on the visualization, Lead and Ammonia have the most on site other disposal."}
chemical_analysis_data %>% 
  ggplot(aes(x = on_site_release_total, y = other_disposal)) +
  geom_point(aes(alpha = 0.3, color = chemical)) +
  labs(title = "'Other' Disposal in On Site Release Total",
       x = "On Site Release Total",
       y = "'Other' Disposal",
       color = "Chemical",
       alpha = "Saturation") +
  theme_minimal() +
  scale_color_viridis_d() +
  scale_fill_viridis_d() +
  facet_wrap(~ chemical)
```

```{r plot-on-site-release-total-by-chemical, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A column graph of 11 chemicals used in U.S. facilities from 2011 to 2021 faceted by chemical. The x axis is the on site release total and the y axis is the 11 chemicals. Ammonia has the highest on site release total, follwed by Styrene and Formaldehyde."}
chemical_analysis_data %>% 
  ggplot(aes(x = on_site_release_total, y = chemical, fill = chemical)) +
  geom_col() +
  labs(title = "On Site Release Total by Chemical",
       x = "On Site Release Total",
       y = "Chemical",
       fill = "Chemical") +
  theme_minimal() +
  scale_fill_viridis_d()
```

### Graphs of on-site disposal by type

These graphs look at on site disposal, distinct from on site release. For both of these visualizations, Ammonia is one of the most prevalent chemicals, however, Formaldehyde is also prevalent in on site containment.

```{r plot-on-site-contained-by-chemical, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A scatter plot of 11 chemicals used in U.S. facilities from 2011 to 2021 faceted by chemical. The x axis is on site total and the y axis is on site contained. Based on this visualization, Ammonia and Formaldehyde have the hightest on site containment."}
chemical_analysis_data %>% 
  ggplot(aes(x = on_site_total, y = on_site_contained)) +
  geom_point(aes(alpha = 0.3, color = chemical)) +
  labs(title = "Contained On Site by Chemical",
       x = "On Site Total",
       y = "On Site Contained",
       color = "Chemical",
       alpha = "Saturation") +
  theme_minimal() +
  scale_color_viridis_d() +
  scale_fill_viridis_d() +
  facet_wrap(~ chemical)
```

```{r plot-on-site-other-by-chemical, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A scatter plot of 11 chemicals used in U.S. facilities from 2011 to 2021 faceted by chemical. The x axis is on site total and the y axis is on site other. Based on this visualization, Ammonia has the highest on site other."}
chemical_analysis_data %>% 
  ggplot(aes(x = on_site_total, y = on_site_other)) +
  geom_point(aes(alpha = 0.3, color = chemical)) +
  labs(title = "On Site 'Other' and On Site Total",
       x = "On Site Total",
       y = "On Site 'Other'",
       color = "Chemical",
       alpha = "Saturation") +
  theme_minimal() +
  scale_color_viridis_d() +
  scale_fill_viridis_d() +
  facet_wrap(~ chemical)
```

### Graphs of off-site disposal by type

We created these graphs to look at the off site disposal by chemical to see if the trends were any different. While Ammonia is present in many of them, it is not nearly as prevalent as it was in on site release and disposal. Instead, we see more of our chemicals represented: Ammonia (6), Lead (3), Formaldehyde (4), Nickel (4), Chromium (4). Styrene is seen as the most prevalent in one of the graphs. However, we found that Chloroform, Benzo[g,h,i]perylene, and Arsenic were not particularly prevalent in any of these graphs, leading us to wonder if they are infrequently used or if we should consider adjusting our methods in the future. 

```{r plot-public-treatment-transfer-by-chemical, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A scatter plot of 11 chemicals used in U.S. facilities from 2011 to 2021 faceted by chemical. The x axis is off site total and the y axis is total transfered to public treatment. Based on this visualization, Formaldehyde and Ammonia are most frequently transfered for public treatment."}
chemical_analysis_data %>% 
  ggplot(aes(x = off_site_total, y = public_treatment_total_transfer)) +
  geom_point(aes(alpha = 0.3, color = chemical)) +
  labs(title = "Total Transfered to Public Treatment and Off Site Total",
       x = "Off Site Total",
       y = "Total Transfered to Public Treatment",
       color = "Chemical",
       alpha = "Saturation")  +
  theme_minimal() +
  scale_color_viridis_d() +
  scale_fill_viridis_d() +
  facet_wrap(~ chemical)
```

```{r plot-off-site-release-total-by-chemical, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A scatter plot of 11 chemicals used in U.S. facilities from 2011 to 2021 faceted by chemical. The x axis is off site total and the y axis is the off site release total. Based on this visualization, Nickel, Lead, Chromium, and Ammonia have the highest off site release total."}
chemical_analysis_data %>% 
  ggplot(aes(x = off_site_total, y = off_site_release_total)) +
  geom_point(aes(alpha = 0.3, color = chemical)) +
  labs(title = "Off Site Release Total and Off Site Total",
       x = "Off Site Total",
       y = "Off Site Release Total",
       color = "Chemical",
       alpha = "Saturation") +
  theme_minimal() +
  scale_color_viridis_d() +
  scale_fill_viridis_d() +
  facet_wrap(~ chemical)
```

```{r plot-off-site-recycled-total-by-chemical, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A scatter plot of 11 chemicals used in U.S. facilities from 2011 to 2021 faceted by chemical. The x axis is off site total and the y axis is total recycled off site. Based on this visualization, Chromium and Nickel are most often recycled off site."}
chemical_analysis_data %>% 
  ggplot(aes(x = off_site_total, y = off_site_recycled_total)) +
  geom_point(aes(alpha = 0.3, color = chemical)) +
  labs(title = "Total Recycled off Site and Off Site Total",
       x = "Off Site Total",
       y = "Total Recycled Off Site",
       color = "Chemical",
       alpha = "Saturation") +
  theme_minimal() +
  scale_color_viridis_d() +
  scale_fill_viridis_d() +
  facet_wrap(~ chemical)
```

```{r plot-off-site-energy-recovery-total-by-chemical, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A scatter plot of 11 chemicals used in U.S. facilities from 2011 to 2021 faceted by chemical. The x axis is off site total and the y axis is total energy recovered off site. Based on this visualization, Styrene has the highest energy recovery."}
chemical_analysis_data %>% 
  ggplot(aes(x = off_site_total, y = off_site_energy_recovery_total)) +
  geom_point(aes(alpha = 0.3, color = chemical)) +
  labs(title = "Total Energy Recovered Off Site and Off Site Total",
       x = "Off Site Total",
       y = "Total Energy Recovered Off Site",
       color = "Chemical",
       alpha = "Saturation") +
  theme_minimal() +
  scale_color_viridis_d() +
  scale_fill_viridis_d() +
  facet_wrap(~ chemical)
```

```{r plot-off-site-treated-total-by-chemical, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A scatter plot of 11 chemicals used in U.S. facilities from 2011 to 2021 faceted by chemical. The x axis is off site total and the y axis is total treated off site. Based on this visualization, Formaldehyde, Styrene, and Ammonia have the highest off site treated total."}
chemical_analysis_data %>% 
  ggplot(aes(x = off_site_total, y = off_site_treated_total)) +
  geom_point(aes(alpha = 0.3, color = chemical)) +
  labs(title = "Total Treated Off Site and Off Site Total",
       x = "Off Site Total",
       y = "Total Treated Off Site",
       color = "Chemical",
       alpha = "Saturation") +
  theme_minimal() +
  scale_color_viridis_d() +
  scale_fill_viridis_d() +
  facet_wrap(~ chemical)
```

```{r plot-total-transfer-by-chemical, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A scatter plot of 11 chemicals used in U.S. facilities from 2011 to 2021 faceted by chemical. The x axis is off site total and the y axis is total transfered. Based on this visualization, Chromium and Nickel have the highest total transfers, though Lead does have one very high outlier."}
chemical_analysis_data %>% 
  ggplot(aes(x = off_site_total, y = total_transfer)) +
  geom_point(aes(alpha = 0.3, color = chemical)) +
  labs(title = "Total Transfered and Off Site Total",
       x = "Off Site Total",
       y = "Total Transfered",
       color = "Chemical",
       alpha = "Saturation") +
  theme_minimal() +
  scale_color_viridis_d() +
  scale_fill_viridis_d() +
  facet_wrap(~ chemical)
```

```{r plot-total-releases-by-chemical, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A scatter plot of 11 chemicals used in U.S. facilities from 2011 to 2021 faceted by chemical. The x axis is off site total and the y axis is total releases. Based on this visualization, Ammonia, Formaldehyde, and Lead have the highest total releases."}
chemical_analysis_data %>% 
  ggplot(aes(x = off_site_total, y = total_releases)) +
  geom_point(aes(alpha = 0.3, color = chemical)) +
  labs(title = "Total Released and Off Site Total",
       x = "Off Site Total",
       y = "Total Released",
       color = "Chemical",
       alpha = "Saturation") +
  theme_minimal() +
  scale_color_viridis_d() +
  scale_fill_viridis_d() +
  facet_wrap(~ chemical)
```

```{r plot-off-site-contain-by-chemical, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A scatter plot of 11 chemicals used in U.S. facilities from 2011 to 2021 faceted by chemical. The x axis is off site total and the y axis is contained off site. Based on this visualization, Nickel, Chromium, Ammonia, Lead, and Formaldehyde have the most contained off site."}
chemical_analysis_data %>% 
  ggplot(aes(x = off_site_total, y = off_site_contain)) +
  geom_point(aes(alpha = 0.3, color = chemical)) +
  labs(title = "Total Contained Off Site and Off Site Total",
       x = "Off Site Total",
       y = "Total Contained Off Site",
       color = "Chemical",
       alpha = "Saturation") +
  theme_minimal() +
  scale_color_viridis_d() +
  scale_fill_viridis_d() +
  facet_wrap(~ chemical)
```

```{r plot-off-site-other-by-chemical, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A scatter plot of 11 chemicals used in U.S. facilities from 2011 to 2021 faceted by chemical. The x axis is off site total and the y axis is off site other. Based on this visualization, Lead and Ammonia have the highest on site other."}
chemical_analysis_data %>% 
  ggplot(aes(x = off_site_total, y = off_site_other)) +
  geom_point(aes(alpha = 0.3, color = chemical)) +
  labs(title = "Off Site 'Other' and Off Site Total",
       x = "Off Site Total",
       y = "Off Site 'Other'",
       color = "Chemical",
       alpha = "Saturation") +
  theme_minimal() +
  scale_color_viridis_d() +
  scale_fill_viridis_d() +
  facet_wrap(~ chemical)
```

### Chemical Release Trends by Year

The last group of plots is chemical release trends by year. The first two plots look at on and off site release total, faceted by year. Then, we created one faceted plot for each chemical, looking at the amount of on and off site release per year and faceting by industry sector category. Note: Phosphorus does not have an individual faceted graph because it is only created by one facility.  

```{r on-site-total-by-year, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A column graph of 11 chemicals used in the U.S between 2011 and 2021 faceted by year. This graph has chemical on the x axis and on site total on the y axis. From this visualization, Ammonia and Formaldehyde consistently have the highest on site total."}
chemical_analysis_data %>% 
  ggplot(aes(x = chemical, y = on_site_total, fill = chemical)) +
  geom_col(position = "dodge") +
  labs(title = "Total On Site By Chemical",
       subtitle = "On Site Release, Storage, and Disposal",
       x = "Chemical",
       y = "On Site Total",
       fill = "Chemical") +
  theme_minimal() +
  coord_flip() +
  scale_fill_viridis_d() +
  facet_wrap(~ year)
```

```{r off-site-total-by-year, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = "A column graph of 11 chemicals used in the U.S between 2011 and 2021 faceted by year. This graph has chemical on the x axis and off site total on the y axis. Based on this visualization, the off site total is low except for Lead in 2012."}
chemical_analysis_data %>% 
  ggplot(aes(x = chemical, y = off_site_total, fill = chemical)) +
  geom_col(position = "dodge") +
    labs(title = "Total Off Site By Chemical",
       subtitle = "Off Site Release, Storage, Treatment, and Disposal",
       x = "Chemical",
       y = "Off Site Total",
       fill = "Chemical") +
  theme_minimal() +
  coord_flip() +
  scale_fill_viridis_d() +
  facet_wrap(~ year)
```

```{r arsenic-release-by-year, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = c("Plot 1 is a column graph of off site Arsenic in the U.S between 2011 and 2021 faceted by industry sector category. This graph has the year on the x axis and off site total on the y axis. The industry sector categories Chemicals and Waste and Machinery and Technology have the highest off site total. For Chemicals and Waste, it is highest in 2011 and has dropped significantly since then, with very little variation between 2015 and 2021. Machinery and Technology increased since 2011, peaked in 2018, and have declined since, with a significant dip in 2020.", "Plot 2 is a column graph of on site Arsenic in the U.S. between 2011 and 2021 faceted by industry sector category. This graph has the year on the x axis and the on site total on the y axis. Based on this graph, Chemicals and waste has the highest on site total, with significant spikes in 2011 and 2013 and falling to consistently low levels between 2014 and 2021 with a slight spike in 2018.")}
chemical_analysis_data %>%
  filter(chemical == "Arsenic") %>%
  ggplot(aes(x = year, y = off_site_total, fill = industry_sector_category)) +
  geom_col(position = "dodge", just = 0.5) +
  labs(title = "Arsenic Off Site Total",
       subtitle = "Arsenic Off Site Release, Storage, Treatment, and Disposal",
       x = "Year",
       y = "Off Site Total",
       fill = "Industry Sector Category") +
  theme_minimal() +
  scale_fill_viridis_d() +
  facet_wrap(~ industry_sector_category)

chemical_analysis_data %>% 
  filter(chemical == "Arsenic") %>% 
  ggplot(aes(x = year, y = on_site_total, fill = industry_sector_category)) +
  geom_col(position = "dodge", just = 0.5) +
  labs(title = "Arsenic On Site Total",
       subtitle = "Arsenic On Site Release, Storage, and Disposal",
       x = "Year",
       y = "On Site Total",
       fill = "Industry Sector Category") +
  theme_minimal() +
  scale_fill_viridis_d() +
  facet_wrap(~ industry_sector_category)
```

```{r styrene-release-by-year, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = c("Plot 1 is a column graph of off site Styrene in the U.S. between 2011 and 2021 faceted by industry sector category. This graph has the year on the x axis and off site total on the y axis. The industry sector category Chemicals and Waste has the highest off site total, with spikes in 2014 and 2016.", "Plot 2 is a column graph of on site Styrene in the U.S. between 2011 and 2021 faceted by industry sector category. This graph has the year on the x axis and the on site total on the y axis. The industry sector categories Chemicals and Waste, Machinery and Technology, and Processed Materials consistently have the highest on site total. Chemicals and Waste has been mostly consistent, with spikes in 2011 and 2013. Machinery and Technology increased between 2011, peaked in 2018, and has declined since. Processed Materials has increased steadily since 2011 and has the highest on site total of these three industry sector categories.")}
chemical_analysis_data %>% 
  filter(chemical == "Styrene") %>% 
  ggplot(aes(x = year, y = off_site_total, fill = industry_sector_category)) +
  geom_col(position = "dodge", just = 0.5) +
  labs(title = "Styrene Off Site Total",
       subtitle = "Styrene Off Site Release, Storage, Treatment, and Disposal",
       x = "Year",
       y = "Off Site Total",
       fill = "Industry Sector Category") +
  theme_minimal() +
  scale_fill_viridis_d() +
  facet_wrap(~ industry_sector_category)

chemical_analysis_data %>% 
  filter(chemical == "Styrene") %>% 
  ggplot(aes(x = year, y = on_site_total, fill = industry_sector_category)) +
  geom_col(position = "dodge", just = 0.5) +
  labs(title = "Styrene On Site Total",
       subtitle = "Styrene On Site Release, Storage, and Disposal",
       x = "Year",
       y = "On Site Total",
       fill = "Industry Sector Category") +
  theme_minimal() +
  scale_fill_viridis_d() +
  facet_wrap(~ industry_sector_category)
```

```{r formaldehyde-release-by-year, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = c("Plot 1 is a column graph of off site Formaldehyde in the U.S. between 2011 and 2021 faceted by industry sector category. This graph has the year on the x axis and the off site total on the y axis. Based on this graph, Chemicals and Waste has the highest off site total, slowly declining between 2011 and 2020 and then drastically spiking in 2021.", "Plot 2 is a column graph of on site Formaldehyde in the U.S. between 2011 and 2021 faceted by industry sector category. This graph has the year on the x axis and the on site total on the y axis. Based on this graph, Chemicals and Waste has an incredibly high on site total between 2011 and 2021. All other industry sector categories have very low to no on site total.")}
chemical_analysis_data %>% 
  filter(chemical == "Formaldehyde") %>% 
  ggplot(aes(x = year, y = off_site_total, fill = industry_sector_category)) +
  geom_col(position = "dodge", just = 0.5) +
  labs(title = "Formaldehyde Off Site Total",
       subtitle = "Formaldehyde Off Site Release, Storage, Treatment, and Disposal",
       x = "Year",
       y = "Off Site Total",
       fill = "Industry Sector Category") +
  theme_minimal() +
  scale_fill_viridis_d() +
  facet_wrap(~ industry_sector_category)

chemical_analysis_data %>% 
  filter(chemical == "Formaldehyde") %>% 
  ggplot(aes(x = year, y = on_site_total, fill = industry_sector_category)) +
  geom_col(position = "dodge", just = 0.5) +
  labs(title = "Formaldehyde On Site Total",
       subtitle = "Formaldehyde On Site Release, Storage, and Disposal",
       x = "Year",
       y = "On Site Total",
       fill = "Industry Sector Category") +
  theme_minimal() +
  scale_fill_viridis_d() +
  facet_wrap(~ industry_sector_category)
```

```{r nickel-release-by-year, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = c("Plot 1 shows a column graph of off site Nickel in the U.S. between 2011 and 2021 faceted by industry sector category. The year is on the x axis and the off site total is on the y axis. Based on this graph, Processed Materials consistently has the highest off site total. However, Machinery and Technology had a massive spike in 2011, drastically declined to consistantly low levels between 2012 and 2020, and then spiked slightly in 2021.", "Plot 2 shows a column graph of on site Nickel in the U.S. between 2011 and 2021 faceted by industry sector category. The year is on the x axis and the on site total is on the y axis. Based on this graph, Chemicals and Waste and Mining have the highest on site total. Chemicals and Waste had low levels between 2011 and 2015, had a massive spike in 2016 and has declined since, though has not reached pre-2015 levels. Mining has an overall consistently low on site total, but is significant when compared to most other industry sector categories.")}
chemical_analysis_data %>% 
  filter(chemical == "Nickel") %>% 
  ggplot(aes(x = year, y = off_site_total, fill = industry_sector_category)) +
  geom_col(position = "dodge", just = 0.5) +
  labs(title = "Nickel Off Site Total",
       subtitle = "Nickel Off Site Release, Storage, Treatment, and Disposal",
       x = "Year",
       y = "Off Site Total",
       fill = "Industry Sector Category") +
  theme_minimal() +
  scale_fill_viridis_d() +
  facet_wrap(~ industry_sector_category)

chemical_analysis_data %>% 
  filter(chemical == "Nickel") %>% 
  ggplot(aes(x = year, y = on_site_total, fill = industry_sector_category)) +
  geom_col(position = "dodge", just = 0.5) +
  labs(title = "Nickel On Site Total",
       subtitle = "Nickel On Site Release, Storage, and Disposal",
       x = "Year",
       y = "On Site Total",
       fill = "Industry Sector Category") +
  theme_minimal() +
  scale_fill_viridis_d() +
  facet_wrap(~ industry_sector_category)
```

```{r chromium-release-by-year, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = c("Plot 1 is a column graph of off site Chromium in the U.S. between 2011 and 2021 faceted by industry sector category. This plot has the year on the x axis and the off site total on the y axis. Based on this graph, Processed Materials had a steady increase from 2011 to 2020 before dropping in 2021. Machinery and Technology had a very high off site total in 2011, a slightly lower one in 2012, and then a very low off site total between 2013 and 2020 before spiking in 2021 to the same level it was in 2020.", "Plot 2 shows a column graph of on site Chromium in the U.S. between 2011 and 2021 faceted by industry sector category. The year is on the x axis and the on site total is on the y axis. This graph shows that Chemicals and Waste and Mining have the highest on site totals. Chemicals and Waste has a moderate on site total in 2011, drops to a low level from 2012 to 2014, increases steadily from 2015 to 2017 before peaking in 2018 and then dropping in 2019, 2020, and 2021. Mining climbs steadily from 2011 to 2014, dips in 2015, and then spikes in 2016 and has been declining since.")}
chemical_analysis_data %>% 
  filter(chemical == "Chromium") %>% 
  ggplot(aes(x = year, y = off_site_total, fill = industry_sector_category)) +
  geom_col(position = "dodge", just = 0.5) +
  labs(title = "Chromium Off Site Total",
       subtitle = "Chromium Off Site Release, Storage, Treatment, and Disposal",
       x = "Year",
       y = "Off Site Total",
       fill = "Industry Sector Category") +
  theme_minimal() +
  scale_fill_viridis_d() +
  facet_wrap(~ industry_sector_category)

chemical_analysis_data %>% 
  filter(chemical == "Chromium") %>% 
  ggplot(aes(x = year, y = on_site_total, fill = industry_sector_category)) +
  geom_col(position = "dodge", just = 0.5) +
  labs(title = "Chromium On Site Total",
       subtitle = "Chromium On Site Release, Storage, and Disposal",
       x = "Year",
       y = "On Site Total",
       fill = "Industry Sector Category") +
  theme_minimal() +
  scale_fill_viridis_d() +
  facet_wrap(~ industry_sector_category)
```

```{r lead-release-by-year, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = c("Plot 1 shows a column graph of off site Lead in the U.S. between 2011 and 2021 faceted by industry sector category. This plot has the year on the x axis and the off site total on the y axis. Based on this graph, all industry sector categories have low off site totals, except for a massive spike in 2012 in Machinery and Technology.", "Plot 2 is a column graph of on site Lead in the U.S. between 2011 and 2021 faceted by industry sector category. This plot has the year on the x axis and the on site total on the y axis. This graph shows that Chemicals and Waste and Processed Materials consistently have the highest on site total. Chemicals and Waste has a big spike in 2011, drops between 2012 and 2014, and then increases in 2016, increases and then flattens in 2017 and 2018, and then declines between 2019 and 2021. Processed Materials begins with a high on site total, declines between 2011 and 2015, spikes in 2015 and has decreased since.")}
chemical_analysis_data %>% 
  filter(chemical == "Lead") %>% 
  ggplot(aes(x = year, y = off_site_total, fill = industry_sector_category)) +
  geom_col(position = "dodge", just = 0.5) +
  labs(title = "Lead Off Site Total",
       subtitle = "Lead Off Site Release, Storage, Treatment, and Disposal",
       x = "Year",
       y = "Off Site Total",
       fill = "Industry Sector Category") +
  theme_minimal() +
  scale_fill_viridis_d() +
  facet_wrap(~ industry_sector_category)

chemical_analysis_data %>% 
  filter(chemical == "Lead") %>% 
  ggplot(aes(x = year, y = on_site_total, fill = industry_sector_category)) +
  geom_col(position = "dodge", just = 0.5) +
  labs(title = "Lead On Site Total",
       subtitle = "Lead On Site Release, Storage, and Disposal",
       x = "Year",
       y = "On Site Total",
       fill = "Industry Sector Category") +
  theme_minimal() +
  scale_fill_viridis_d() +
  facet_wrap(~ industry_sector_category)
```

```{r mercury-release-by-year, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = c("Plot 1 is a column graph of off site Mercury in the U.S. between 2011 and 2021 faceted by industry sector category. The year is on the x axis and the off site total is on the y axis. Based on this graph, Chemicals and Waste has the highest off site total. It spikes from relatively low levels in 2013 and 2014 and has a massive spike in 2016.", "Plot 2 shows a column graph of on site Mercury in the U.S. between 2011 and 2021 faceted by industry sector category. The x axis is the year and the y axis is the on site total. The graph shows that Chemicals and Waste has the highest on site total, with consistently low levels and two massive spikes in 2014 and 2016.")}
chemical_analysis_data %>%
  filter(chemical == "Mercury") %>%
  ggplot(aes(x = year, y = off_site_total, fill = industry_sector_category)) +
  geom_col(position = "dodge", just = 0.5) +
  labs(title = "Mercury On Site Total",
       subtitle = "Mercury On Site Release, Storage, and Disposal",
       x = "Year",
       y = "On Site Total",
       fill = "Industry Sector Category") +
  theme_minimal() +
  scale_fill_viridis_d() +
  facet_wrap(~ industry_sector_category)

chemical_analysis_data %>% 
  filter(chemical == "Mercury") %>% 
  ggplot(aes(x = year, y = on_site_total, fill = industry_sector_category)) +
  geom_col(position = "dodge", just = 0.5) +
  labs(title = "Mercury On Site Total",
       subtitle = "Mercury On Site Release, Storage, and Disposal",
       x = "Year",
       y = "On Site Total",
       fill = "Industry Sector Category") +
  theme_minimal() +
  scale_fill_viridis_d() +
  facet_wrap(~ industry_sector_category)
```

```{r ammonia-release-by-year, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = c("Plot 1 shows a column graph of off site Ammonia in the U.S. between 2011 and 2021 faceted by industry sector category. The year is on the x axis and the off site total is on the y axis. Based on this graph, Agriculture and Food Processing, Chemicals and Waste, Electric Utilities, and Processed Materials have the highest off site total. Agriculture and Food Processing, Electric Utilities, and Processed Materials each have consistently low or declining off site totals. Chemicals and Waste has consistently low levels except for significant spikes in 2012, 2014, and 2015.", , "Plot 2 is a column graph of on site Ammonia in the U.S. between 2011 and 2021 faceted by industry sector category. The x axis is the year and the y axis is the on site total. This graph shows that Chemicals and Waste has the highest on site total by a large margin, with a steady increase between 2011 and 2021 except for a drop in 2015. Agriculture and Food Processing and Processed Materials each have consistently low on site totals.")}
chemical_analysis_data %>% 
  filter(chemical == "Ammonia") %>% 
  ggplot(aes(x = year, y = off_site_total, fill = industry_sector_category)) +
  geom_col(position = "dodge", just = 0.5) +
  labs(title = "Ammonia Off Site Total",
       subtitle = "Ammonia Off Site Release, Storage, Treatment, and Disposal",
       x = "Year",
       y = "Off Site Total",
       fill = "Industry Sector Category") +
  theme_minimal() +
  scale_fill_viridis_d() +
  facet_wrap(~ industry_sector_category)

chemical_analysis_data %>% 
  filter(chemical == "Ammonia") %>% 
  ggplot(aes(x = year, y = on_site_total, fill = industry_sector_category)) +
  geom_col(position = "dodge", just = 0.5) +
  labs(title = "Ammonia On Site Total",
       subtitle = "Ammonia On Site Release, Storage, and Disposal",
       x = "Year",
       y = "On Site Total",
       fill = "Industry Sector Category") +
  theme_minimal() +
  scale_fill_viridis_d() +
  facet_wrap(~ industry_sector_category)
```

```{r chloroform-release-by-year, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = c("Plot 1 is a column graph of off site Chloroform in the U.S. between 2011 and 2021 faceted by industry sector category. The x axis is the year and the y axis is the off site total. This graph shows that Chemicals and Waste is the industry sector witht the highest off site total, climbing between 2011 and 2013, dropping in 2014, and steadily rising since.", "Plot 2 shows a column graph of on site Chloroform in the U.S. between 2011 and 2021 faceted by industry sector catefory. The x axis is the year and the y axis is the on site total. This graph shows that Wood and Paper and Agriculture and Food Processing both have low on site totals between 2011 and 2021. Chemicals and Waste has a low on site total except for significant spikes in 2016 and 2017.")}
chemical_analysis_data %>% 
  filter(chemical == "Chloroform") %>% 
  ggplot(aes(x = year, y = off_site_total, fill = industry_sector_category)) +
  geom_col(position = "dodge", just = 0.5) +
  labs(title = "Chloroform Off Site Total",
       subtitle = "Chloroform Off Site Release, Storage, Treatment, and Disposal",
       x = "Year",
       y = "Off Site Total",
       fill = "Industry Sector Category") +
  theme_minimal() +
  scale_fill_viridis_d() +
  facet_wrap(~ industry_sector_category)

chemical_analysis_data %>% 
  filter(chemical == "Chloroform") %>% 
  ggplot(aes(x = year, y = on_site_total, fill = industry_sector_category)) +
  geom_col(position = "dodge", just = 0.5) +
  labs(title = "Chloroform On Site Total",
       subtitle = "Chloroform On Site Release, Storage, and Disposal",
       x = "Year",
       y = "On Site Total",
       fill = "Industry Sector Category") +
  theme_minimal() +
  scale_fill_viridis_d() +
  facet_wrap(~ industry_sector_category)
```

```{r benzo[g,h,i]perylene-release-by-year, echo = FALSE, message = FALSE, warning = FALSE, fig.alt = c("Plot 1 shows a column graph of off site Benzo[g,h,i]perylene in the U.S. between 2011 and 2021 faceted by industry sector category. The year is on the x axis and the off site total is on the y axis. Based on the graph, Petroleum has the highest off site total, which is generally low except for a moderate spike in 2014 and a massive spike in 2017.", "Plot 2 is a column graph of on site Benzo[g,h,i]perylene in the U.S. between 2011 and 2021 faceted by industry sector category. The x axis is the year and the y axis is the on site total. The graph shows that Chemicals and Waste and Processed Materials have the highest on site totals. Chemicals and waste is inconsistent, with the highest on site totals in 2012 and 2016. Processed materials has a generally low on site total with two almost even spikes in 2012 and 2013.")}
chemical_analysis_data %>% 
  filter(chemical == "Benzo[g,h,i]perylene") %>% 
  ggplot(aes(x = year, y = off_site_total, fill = industry_sector_category)) +
  geom_col(position = "dodge", just = 0.5) +
  labs(title = "Benzo[g,h,i]perylene Off Site Total",
       subtitle = "Benzo[g,h,i]perylene Off Site Release, Storage, Treatment, and Disposal",
       x = "Year",
       y = "Off Site Total",
       fill = "Industry Sector Category") +
  theme_minimal() +
  scale_fill_viridis_d() +
  facet_wrap(~ industry_sector_category)

chemical_analysis_data %>% 
  filter(chemical == "Benzo[g,h,i]perylene") %>% 
  ggplot(aes(x = year, y = on_site_total, fill = industry_sector_category)) +
  geom_col(position = "dodge", just = 0.5) +
  labs(title = "Benzo[g,h,i]perylene On Site Total",
       subtitle = "Benzo[g,h,i]perylene On Site Release, Storage, and Disposal",
       x = "Year",
       y = "On Site Total",
       fill = "Industry Sector Category") +
  theme_minimal() +
  scale_fill_viridis_d() +
  facet_wrap(~ industry_sector_category)
```

# Conclusion

In recognizing the increase of observations, increase in pollution trends, and the environment of increasingly strict reporting laws, we must be careful not to make the assumption that pollution is truly on the rise, and that conditions are getting worse in general. What the legal environment shows is an increase in control and recognition of needed chemical regulations. What the work shows is a very actively polluted environment irregardless of these laws, and the continued prevalence of chemicals that are known to have been used as weapons of war and for body-preservation and alteration -- clearly harmful to human health. This is not to say that there is no improvement, but that there surely is much more that must be done. 
